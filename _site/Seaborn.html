<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link href="https://fonts.googleapis.com/css?family=Maven+Pro:400,500&amp;subset=latin-ext,vietnamese" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Dancing+Script:400,700&amp;subset=vietnamese" rel="stylesheet">
  <meta name="google-site-verification" content="8zqeFQNuNAWS7ye6oN69hdEeYC_RsDyAlhht79xtAQo" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/assets/res/banner.png" />

  

  <title>
    
      Seaborn - appunti | 4Phycs
    
  </title>

  

  <!-- page's cover -->
  
    <meta property="og:image" content="http://localhost:4000/images/posts/Seaborn_files/seaborn_Capture.PNG" />
    <meta property="og:image:width" content="1234">
    <meta property="og:image:height" content="592">
  

  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
  

  <link rel="shortcut icon" type="image/x-icon" href="/assets/res/favicon.png">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/materialize/0.99.0/css/materialize.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="/assets/css/main.css">

  <link rel="stylesheet" href="/assets/css/thi_scss.css">

  
    
      <link rel="stylesheet" href="/assets/css/post.css">
    
  

  

  <link rel="stylesheet" href="/assets/css/syntax.css">
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
  <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">
  
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Seaborn - appunti" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Seaborn: Questi appunti contengono esempi, commenti e grafici basati sul bel video di Derek Banas di Simplilearn. Qualunque errore e’ dovuto a me e non da imputare a Derek Banas. Ho aggiunto anche pensieri e esempi che mi servivano. In alcuni casi i comandi indicati da Banas mi davano problemi, probabilmente per le versioni di Python/Matplotlib/Seaborn. Ho cercato di farli girare con dei piccoli cambiamenti. La mia versione e’ basata su una Anaconda aggiornata al Novembre 2020, all’interno di un Jupyter notebook. Alle volte faccio dei paragoni con Gnuplot, dato che e’ il mio sistema di visualizzazione di base… E’ capitato che facessi degli errori banali, ho lasciato le note sulle soluzioni perche’ possono essere utili. Introduzione: Seaborn e’ una libreria che lavora su Matplotlib e Pandas. Visto che un DataFrame di Pandas ha molte colonne, spesso sara’ necessario fare dei grafici multipli che contengano informazioni di tutte le coppie di colonne. In questo senso si puo’ vedere Seaborn come una serie di script che forniscono delle combinazioni di comandi che rendono veloce e semplice le visualizzazioni multiple (per progetti di data science). Alternativamente a Matplotlib esiste un’altra libreria chiamata bokeh (che esplorero’ in seguito) Trucco utilissimo (che non conoscevo/ricordavo) di Jupyter notebook cliccki su una cella clicchi su una funzione premi shift-tab: ti fa vedere tutti gli argomenti che possono essere passati a quella funzione Quando mi riferisco alle funzioni di Seaborn, non parlo di metodi associati ai DataFrame. La sola differenza e’ che non si applicano tramite la dot “notation” dei metodi. Il DataFrame (o sue parti) e’ passato come argomenti delle funzioni stesse. Inoltre ci possono essere altri argomenti utili, come per esempio: hue (assegna colori diversi a valori diversi, p.es. maschi e femmine) palette (sono combinazioni di colori, in cui viene definita una topologia di colori, per esemppio il successivo a questo rosso e’ quest’altro rosso…) styling (per cambiare la dimensione delle label..) set_style (cambia lo sfondo) non funge (forse perche’ faccio girare la cella dopo averne fatta girare un’altra che ha lasciato qualcosa in memoria) font_scale (grandezza delle label) spine (gli assi, laterali e verticali) ATTENTO: va messo sotto il comando sns.joinplot figsize (indica l’aspect ratio del rettangolo, base e poi altezza). ATTENTO, in jupyter puoi chiedere che matplotlib sia inline, questo fa si’ che le figure siano dei png sul notebook, e si puo’ definire un dpi. Questo ultimo comando “fissa” la dimensione visibile della figura! spine sono gli assi! legend (la legenda) jitter (per fare uno spredout dei punti in alcuni tipi di plot) side by side ( per mettere 2 figure di seaborn una da parte all’altra cerca: subplots) palettes (cerca la lista: maplotlib colormaps https://matplotlib.org/3.3.3/tutorials/colors/colormaps.html ) pivot tables (per fare le matrici, definisci le righe e le colonne. Questo seleziona dei valori. Tipicamente per questi valori esistono varie righe del DataFrame, da cui posso estrarre un grafico per ognuna delle righe e colonne della pivot table.) In prarica una pivot table fa un prodotto cartesiano tra tutti gli elementi delle righe e delle colonne. Subplot figure una di lato all’altra,o meglio all’interno di una “griglia” dove ci possono essere tanti grafici. Attento devi mettere il seguente con seaborn, che non c’e’ nel video di Banas: ax=axes[0] # per il primo ax=axes[1] # per il secondo oggetto. Se non li metti il sistema non fa vedere la prima figura ma disegna un plot vuoto e fa vedere da parte l’ultimo plot disegnato. Ho trovato l’esempio con i pokemon (sebbene la pagina sia poco leggibile): https://dev.to/thalesbruno/subplotting-with-matplotlib-and-seaborn-5ei8 TRUCCO ci sono vari magic command di Matplotlib oltre al solito inline: %matplotlib inline - Figures are shown as static png images (optionally svg if configured) %matplotlib notebook or %matplotlib nbagg - Interactive Figures inside the notebook %matplotlib widgets - - Interactive Figures inside the notebook (requires jupyter-matplotlib to be installed) %matplotlib tk or Nota tecnica: Ho notato che una TOC poteva risultare utile, per questo ho installato jupyter-navbar. Ho semplicemente scaricato lo zip da https://github.com/shoval/jupyter-navbar e (dopo avere decompresso) ho fatto girare da Babun con python2.7 il file setup.py (questo perche’ lo sto facendo girare in Windows 10). In questo modo appare la barra con l’indice. import numpy as np import pandas as pd import matplotlib.pyplot as plt import seaborn as sns #sns.set() %matplotlib inline #%matplotlib notebook #%matplotlib tk #%matplotlib widgets # questi sotto non so ancora cosa facciano %reload_ext autoreload %autoreload 2 #cs_df = pd.read_csv(&#39;ComputerSales.csv&#39;) # dovrei trovarlo Dataset di Seaborn posso sapere la lista di questi dataset e anche caricarli velocemente con il metodo load_dataset print (sns.get_dataset_names()) [&#39;anagrams&#39;, &#39;anscombe&#39;, &#39;attention&#39;, &#39;brain_networks&#39;, &#39;car_crashes&#39;, &#39;diamonds&#39;, &#39;dots&#39;, &#39;exercise&#39;, &#39;flights&#39;, &#39;fmri&#39;, &#39;gammas&#39;, &#39;geyser&#39;, &#39;iris&#39;, &#39;mpg&#39;, &#39;penguins&#39;, &#39;planets&#39;, &#39;tips&#39;, &#39;titanic&#39;] crash_df = sns.load_dataset(&#39;car_crashes&#39;) print(crash_df.shape) print(crash_df.head(3)) (51, 8) total speeding alcohol not_distracted no_previous ins_premium \ 0 18.8 7.332 5.640 18.048 15.040 784.55 1 18.1 7.421 4.525 16.290 17.014 1053.48 2 18.6 6.510 5.208 15.624 17.856 899.47 ins_losses abbrev 0 145.08 AL 1 133.93 AK 2 110.35 AZ Distribution Plots Distribution Plot sns.distplot(miaSerie): questa funzione, in pratica, se applicata ad una Series di Pandas produce automaticamente un istogramma. Occhio che il comando qui sotto e’ deprecato, e verra rimosso in futuro. Non e’ chiaro perche’, ma nelle note del “warning” di python indicano di usare una funzione con lo stesso nome: distplot ma che e’ “a figure-level function”, oppure: histplot Questa funzione in ogni modo fa un istogramma di una colonna (Series) di un dataframe di Pandas. Inoltre per default fa anche un kernel density estimation (KDE), possiamo spegnerlo con kde=False bins e’ il numero di bin dell’immagine, non la loro larghezza (ovviamente visto che ha una s…) sns.distplot(crash_df[&#39;not_distracted&#39;], kde=False, bins=15) C:\ProgramData\Anaconda3\lib\site-packages\seaborn\distributions.py:2551: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms). warnings.warn(msg, FutureWarning) &lt;AxesSubplot:xlabel=&#39;not_distracted&#39;&gt; Joint Plots La funzione: sns.jointplot costruisce uno scatterplot con “aggiunte”. viene fatto per paragonare 2 distribuzioni diverse (che saranno 2 colonne di un DataFrame). In pratica fa un scatter plot, e sopra e sotto mette anche gli istogrammi relativi alle colonne. inolte si puo’ aggiungere al volo una regressione lineare con il comando kind=&#39;reg&#39; nello scatterplot e i kernel sopra gli istogrammi. il comando kind definisce lo stile di visualizzazione. vanno passate delle x e delle y in forma di Series che costituiranno le coordinate dei punti dello scatterplot. Ovviamente il numero di oggetti delle x e delle y deve essere lo stesso, altrimenti per un punto ci sarebbe solo una coordinata ma non la seconda… sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df, kind =&#39;reg&#39; ); sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df ); # ho tolto la curva con il kernel estimation e la regressione Attenzione che il grafo nel video non ha solo le isoipse ma anche un sistema di colorazione che in qui sotto non appare! sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df, kind= &#39;kde&#39; ); sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df, kind= &#39;hex&#39; ); KDE plot La funzione Kdeplot costruisce una sorta di interpolazione dei dati di una series. nota che nel grafico sotto non appare la legenda, mentre nel video c’e’ di default! sns.kdeplot(crash_df[&#39;alcohol&#39;]); Pair Plot Fa vedere la relazione tra tutte le coppi di colonne contenenti valori numerici dell’intero DataFrame. Esclude i valori categorici Occhio che e’ lento! Anche in questo caso il comando kind=... definisce come viene visualizzato lo scatterplot. Nell’esempio sotto solo le isoipse. sns.pairplot(crash_df, kind = &#39;kde&#39;); # nel video fa anche i colori e non solo le linee di livello Pairplot Hue hue assegna un colore diverso a tutti i valori della colonna indicata. Per esmepio in questo caso hue=’sex’, quindi i punti associati a Male e Female sono colorati in modo diverso. In pratica lui va a prendere i dati, li divide per sesso, poi li disegna automaticamente sullo stesso grafico ma con colori diversi! Nota: si puo’ usare anche con variabili categoriche, non solo le variabili numeriche (anzi penso che possa avere dei problemi se le variabili numeriche sono float…) tips_df = sns.load_dataset(&#39;tips&#39;) print(tips_df.head(3)) sns.pairplot(tips_df, hue=&#39;sex&#39;, palette=&#39;Blues&#39;); # occhio che qui c&#39;e&#39; il sesso del pagante non del ricevente... total_bill tip sex smoker day time size 0 16.99 1.01 Female No Sun Dinner 2 1 10.34 1.66 Male No Sun Dinner 3 2 21.01 3.50 Male No Sun Dinner 3 Rug plot Questo tipo di grafico fa vedere delle lineette per ogni punto. In pratica fa un unfolding di un istogramma. sns.rugplot(tips_df[&#39;tip&#39;]); Styling serve per modificare l’aspetto delle figure Problema, se cambio i parametri di figsize, mi restituisce un “Figure size 576x864 with 0 Axes”, e i valori contenuti sono coerenti coi parametri che ho dato… ma il grafico non viene modificato! Forse il problema e’ legato all’inline lanciato all’inizio mentre in un eventuale salvataggio a file otterrei dei risultati differenti? spine e’ il termine tecnico associato agli assi. Se per esempio non voglio che uno degli assi appaia nel grafico posso usare la funzione despine. Attenzione che va messo sotto il comando del disegno joinplot altrimenti non ha effetto! set_context modifica i parametri in modo che la dimensione dei font e del grafico siano proporzionati in base al contesto. Per esempio se faccio un poster ho bisogno di label grandi… set_style sono le combinazioni di colori dello sfondo #sns.set_style (&#39;white&#39;) sns.set_style (&#39;darkgrid&#39;) #sns.set_style (&#39;whitegrid&#39;) #sns.set_style (&#39;ticks&#39;) plt.figure(figsize=(8,5)) # non funge, devo capire perche&#39;! sns.set_context(&#39;paper&#39;, font_scale=1.5) #sns.set_context(&#39;talk&#39;, font_scale=1.5) # ingrandisce tutto #sns.set_context(&#39;poster&#39;, font_scale=1.5) sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data= crash_df, kind=&#39;reg&#39;); sns.despine(left=True, right=False, top=True, bottom=False) # Occhio va messo SOTTO joinplot altrimenti non fa nulla &lt;Figure size 576x360 with 0 Axes&gt; Categorical Plotting Bar Plots barplot() di default fa vedere la mean La barra nera fa vedre la varianza devo passare cosa ci sia sulle x e sulle y (e il dataframe da cui sono prese) sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df); Possiamo usare funzioni diverse per stimare i valori categorici, per esempio tutti quelli in numpy, come la mediana, o la moda (non mi e’ riuscito)! Attento se fai 2 barplot, li sovrappone e non si capisce nulla Si possono usare delle funzioni custom fatte da noi, suppongo che di base si debba lavorare con un oggetto di tipo Series di Pandas #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.median); # mediana #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.std); # deviazione standard #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.var); # varianza sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.cov); # covarianza #from scipy.stats import mode # non sono riuscito a fargli usare la moda #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=mode); Count Plot countplot e’ come un barplot ma l’estimatore conta solo il numero di occorrenze, per questo non ha bisogno della y (e’ automaticamente il numero di occorrenze) sns.countplot(x=&#39;sex&#39;, data=tips_df) &lt;AxesSubplot:xlabel=&#39;sex&#39;, ylabel=&#39;count&#39;&gt; Box Plot boxplot() fa vedere il grafico a baffi con i quartili dei dati. la linea nera e’ la mean la scatola si estende di una deviazione standard (siamo sicuri? calcola la deviazione standard destra e sinistra? Di solito (wikipedia) la scatola indica il primo e il terzo quartile, devo controllare). I whiskers (baffi) si estendono fino ??? .In alcune rappresentazioni si estendono fino al massimo e al minimo I punti sono outliers (che non stanno nei baffi). Non e’ spiegato bene nella documentazione di Seaborn. Se usano la convenzione per gli outlier che uso io e’ Q3 + 3 IQ (dove l’interquartile e’ la differenza tra il terzo e il primo quartile IQ= Q3-Q1). sulle x vengono selezionati vari insiemi di dati sulle y viene fatto il grafico a baffi di quei particolari dati (vedi il grafico che e’ chiaro) L’estensione dei whisker non viene spiegata bene nelle note di Seaborn. sns.boxplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); plt.legend(loc=1); # la legenda in alto a sx e&#39; loc =0 Violin Plot Una combinazione di boxplot e kde plot, dove usa i kernel. Il nome e’ ovvio… sns.violinplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); # E&#39; inutile mettere tutto il violino per una sola categoria, mettiamo mezzo per una e mezzo per l&#39;altra: split sns.violinplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;,split=True); Strip plot stripplot() si usa quando una variabile e’ categorica: jitter non mi pare che faccia una grande differenza, dovrebbe sparpagliare meglio i punti hue funziona assegna dei colori diversi in base ad una variabile categorica dodge, separa fisicamente i punti con hue differente Prima non disegnava correttamente, perche’ dove avevo scritto fig, ax= plt.subplots(1,2, figsize=(15,5)) avrei invece dovuto scrivere ‘fig, axes=…’ ###### HO fatto qualche modifica rispetto al video, in modo da paragonare con e senza jitter ##### #plt.figure(figsize=(8,5)) fig, axes =plt.subplots(1,2 ,figsize=(15, 5) ) # grafici uno da parte all&#39;altro sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, ax=axes[0]); sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, ax=axes[1], jitter=True); #fig.show() # non serve in un jupyter notebook sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True); # jitter muove un po&#39; in giro i punti sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, hue=&#39;sex&#39;); Separo le hue, ma le lascio allo stesso giorno. Questo viene ottenuto tramite il comando dodge separa fisicamente i due gruppi di punti. sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, hue=&#39;sex&#39;, dodge=True); Swarm plot (lo sciame) violinplot() combina i plot precedenti. in pratica definisce la posizione dei punti come se fossero delle foglie, il primo al centro poi un a dx in alto , sx in alto.. Prima riguardiamo il violino (poi lo confrontiamo con lo swarmplot) sns.violinplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df); # poi vediamo lo sciame. sns.swarmplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df); # metto insieme il violino e lo sciame sns.violinplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df); sns.swarmplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df, color=&#39;white&#39;); Palettes palette e’ un parametro una palette e’ un insieme di colori predefiniti. in cui definiamo anche una topologia tra colori: ovvero quale colore e’ vicino a quale colore. punto di partenza una palette standard Le palette si trovano qui: https://matplotlib.org/3.3.3/tutorials/colors/colormaps.html ) plt.figure(figsize=(8,5)) # funge! se non lo metto sotto diventa tutto piu&#39; piccolo sns.set_style(&#39;dark&#39;) sns.set_context(&#39;talk&#39;) sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); cambio palette plt.figure(figsize=(8,5)) sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;, palette=&#39;PuBu&#39;); # PuBu=palette trovata su matplotlib Legend qualche comando per muovere la legenda. In teoria: loc = 0 sceglie lui la posizione ottimale upper right=1 upper left =2 lower left =3 lower right =4 Cerca Matplotib legends e ci sono tutte le opzioni https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.legend.html #plt.figure(figsize=(8,5)) # funge! se non lo metto sotto diventa tutto piu&#39; piccolo plt.figure(figsize=(8,7)) # funge! se non lo metto sotto diventa tutto piu&#39; piccolo sns.set_style(&#39;dark&#39;) sns.set_context(&#39;talk&#39;) sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); #plt.legend(loc=0) # best = sceglie lui la posizione #plt.legend(loc=1) # in alto a dx #plt.legend(loc=2) # in alto a sx #plt.legend(loc=3) # in basso a sx plt.legend(loc=4) # in basso a dx &lt;matplotlib.legend.Legend at 0x12265a93550&gt; Matrix Plot In questo caso vogliamo visualizzare una matrice, ovvero un oggetto con righe e colonne. In ogni ingresso della matrice avro’ dei valori e voglio visualizzarli. Heatmaps heatmap() qui sotto prendiamo il crash_df e cerchiamo di costruire delle heatmaps argomenti utili: cmap = ‘Blues’ e’ la colormap annot =True scrivi anche il valore della colorazione nella casella (altrimenti fa solo il colore) crash_df.head(3); # riguardiamo questo df Qui sotto uso un metodo (di Pandas?) per cui dato un dataframe con valori numerici e categorici calcola la correlazione tra ogni coppia di colonne numeriche crash_mx = crash_df.corr() crash_mx.head(3) total speeding alcohol not_distracted no_previous ins_premium ins_losses total 1.000000 0.611548 0.852613 0.827560 0.956179 -0.199702 -0.036011 speeding 0.611548 1.000000 0.669719 0.588010 0.571976 -0.077675 -0.065928 alcohol 0.852613 0.669719 1.000000 0.732816 0.783520 -0.170612 -0.112547 plt.figure(figsize=(8,6)) sns.set_context(&#39;paper&#39;, font_scale=1.4) #sns.heatmap(crash_mx, annot=True, cmap=&#39;Blues&#39;) # fa vedere anche i numeri nelle caselle colorate sns.heatmap(crash_mx, annot=False, cmap=&#39;magma&#39;) # fa vedere SOLO i colori &lt;AxesSubplot:&gt; Pivot Table questo e’ un altro modo per costruire una matrice. NEll’esempio sotto quello che fa e’: indico l’index ovvero l’attributo che viene usato per l’indice di riga indico le columns, ovvero l’attributo che viene usato per l’indice di colonna A questo punto lui va. Controlla tutti gli i valori dell’attributo per l’index. Li usa per costruire una tabelle di cui sono tutte le righe. Poi va e controlla i valori dell’attributo per le columns e costruisce le colonne. Poi va e pesca per ognuno degli attributi dell’index e delle columns i valori dati come values e li mette nelle caselle. flights = sns.load_dataset(&#39;flights&#39;) flights.head(3) year month passengers 0 1949 Jan 112 1 1949 Feb 118 2 1949 Mar 132 flights.pivot_table(index=&#39;month&#39;, columns=&#39;year&#39;, values=&#39;passengers&#39;) # NON lavora INPLACE (invece nel video si&#39;) flights_pt = flights.pivot_table(index=&#39;month&#39;, columns=&#39;year&#39;, values=&#39;passengers&#39;) #sns.heatmap(flights.pivot_table(index=&#39;month&#39;, columns=&#39;year&#39;, values=&#39;passengers&#39;), annot=False, cmap=&#39;Blues&#39;) # IDENTICO fig, axes = plt.subplots(1, 2, figsize=(12, 5), sharey=True) sns.heatmap (flights_pt, ax=axes[0],annot=False, cmap=&#39;Blues&#39;) sns.heatmap (flights_pt, ax=axes[1],annot=False, cmap=&#39;Blues&#39;, linecolor=&#39;white&#39;, linewidth=1) ; #larghezza linea default 0? Cluster Map clustermap() hierarchically clusterd heatmap = heatmap ottenuta cone una clusterizzazione gerarchica la distanza tra tutti i punti e’ calcolata i piu’ vicini sono uniti il lavoro continua con il prossimo vicino quindi paragona le colonne e le righe A differenza della heatmap, dove l’ordine degli attributi e’ mantenuto costante, in questo caso viene riordinato seguendo il clustering. iris = sns.load_dataset(&#39;iris&#39;) # e&#39; un pandas dataframe di default iris.head(3) #sns.clustermap(iris) sepal_length sepal_width petal_length petal_width species 0 5.1 3.5 1.4 0.2 setosa 1 4.9 3.0 1.4 0.2 setosa 2 4.7 3.2 1.3 0.2 setosa species = iris.pop(&#39;species&#39;) # pop spara fuori una colonna e la trasforma in una Series Heatmap ottenuta con una clusterizzazione gerarchica sns.clustermap(iris); # heatmap ottenuta con una clusterizzazione gerarchica Ricorda che la pivot table ho dovuto rinominarla, per lui fights e’ la pivot table, per me e’ flights_pt #sns.clustermap(flights , cmap =&#39;Blues&#39;, standard_scale =1) # NON FUNGE normalizza i dati per focalizzarci sul clustering sns.clustermap(flights_pt , cmap =&#39;Blues&#39;, standard_scale =1); # normalizza i dati per focalizzarci sul clustering un commento a quanto qui sopra. Pensale in termine di sequenze numeriche, in cui il colore e’ un numero. Puoi avere sequenze verticali e orizzontali. Prendiamo ora le sequenze orizzontali. Le due piu’ in alto sono molto chiare, ma non sono le piu’ vicine, infatti Nov e Jan sono connesse. Poi si connette Feb. Non mi e’ chiaro il dendrogramma come venga poi costruito. Mi pare di capire che alla fine ci possano essere solo delle coppie. Se il primo vicino di una sequenza e’ gia’ in una coppia, questa rimane isolata e va attaccata alla coppia oppure… devo pensare all’algoritmo. Nota che a causa del clustering mi aspetto di vedere striscie. Questo perche’ sequenze simili vanno messe vicine tra loro. Potrebbero mettere un puntino al centro di ogni cella. Questo punto si puo’ muovere sull’asse delle z o delle y .Il modvimento e’ lo stesso sui due assi e in questo modo si vedono le sequenze sia guardando le righe che le colonne! Pair Grids PairGrid() Prima abbiamo visto i pairplots, dove si facevano degli scatter plot tra tutte le coppie di colonne del DataFrame. Per prima cosa creiamo una grid vuota. iris = sns.load_dataset(&#39;iris&#39;) iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie iris_g.map(plt.scatter); # questo mi pare un comando di matplotlib o PANDAS Ora vogliamo mettere un istogramma lungo la diagonale (della griglia di grafici). iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie #iris_g.map(plt.scatter); # questo mi pare un comando di matplotlib o PANDAS iris_g.map_diag(plt.hist); # nei grafi diagonali inserisce un istogramma iris_g.map_offdiag(plt.scatter); # non mette gli scatterplot diagonali! (occhio che devi commentare l&#39;altro!) Ora vogliamo mettere delle altre cose nella: parte superiore (della matrice di grafici) parte inferiore (della matrice di grafici) quindi diamo un comando chen indica cosa mettere sulla diagonale e poi uno per la triangolare superiore e uno per la triangoplar e superiore. Occhio che si deve passare come argomento di map_diag (oppure map_lower o map_upper) il nome della funzione che si userebbe per diegnare un singolo plot di questo tipo. iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie iris_g.map_diag(plt.hist); # nei grafi diagonali inserisce un istogramma iris_g.map_upper(plt.scatter); # sopre metti gli scatter plot iris_g.map_lower(sns.kdeplot); # sotto metti KDE quindi devi usare la funzione di SEABORN Variabili per la nostra custom grid #iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie iris_g = sns.PairGrid(iris, hue=&#39;species&#39;, x_vars=[&quot;sepal_length&quot;, &quot;sepal_width&quot;], y_vars= [&quot;petal_length&quot;, &quot;petal_width&quot;] ) iris_g.map(plt.scatter); # map e&#39; usata in modo molto potente iris_g.add_legend(); Facet Grid FacetGrid() E’ una specie di subplots di matplotlib ma con delle cose predefinite. posso disegnare plot multipli in una griglia (grid) posso definire le colonne e righe Si crea un sistema a forma di griglia (in cui pero’ non abbiamo ancora messo nulla). Al primo passo indico le colonne e le righe, per esempio: nelle colonne metto il tempo (time). Che puo’ assumere 2 valori: Dinner e Lunch nelle righe metto ‘smoker’. Che puo’ assumere 2 valori: yes e no Quindi la griglia che ho creato e’ 2x2. In ogni ingresso della griglia devo mettere un grafico. Cosa metto? Map Il metodo map() di python e’ utilissimo perche’ posso passare anche delle funzioni! Mappo ogni grafo con il metodo map() e faccio un istogramma della quantita’ ‘total_bill’. Queste quantita’ saranno limitata al valore di ‘time’ e ‘smoker’ corrispondente alla griglia! Quindi per esempio in alto a sx: smoker = yes time = lunch Faccio l’istogramma di tutti i ‘total_bill’ che si riferiscono a smoker e lunch. Ricapitolando con FacetGrid definisco una griglia associata a due colonne, che formeranno le righe e le colonne della griglia. Per ogni valore di ciascuna delle due colonne faccio un grafico riferito, ad una terza colonna tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) # qui resta vuota. sns.set_context(&#39;paper&#39;, font_scale=1.5) tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) tips_fg.map(plt.hist, &#39;total_bill&#39;, bins=8 ); # mappa la funzione plt.hist, sulla quantita &#39;total_bill&#39; tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) tips_fg.map(plt.hist, &#39;day&#39; ) &lt;seaborn.axisgrid.FacetGrid at 0x122685a3ac0&gt; tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) tips_fg.map(plt.scatter, &#39;total_bill&#39;, &#39;tip&#39;); Nel caso sotto invece, facciamo una griglia che contiene solo colonne. Non ci sono righe, pero’ adesso usiamo il comando hue che ci permette di usare un colore diverso in base all’argomento usato. In questo caso uso come hue=’smoker’ Aggiungo un prametro, col_order che mi consente di ordinare le colonne. Basta mettere una lista contenente il nome delle colonne volute e l’ordine di quella lista sara’ seguito dal plot. tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, hue=&#39;smoker&#39;, height=4, aspect=1.3, col_order=[&#39;Dinner&#39;,&#39;Lunch&#39;] , palette=&#39;Set1&#39;) tips_fg.map(plt.scatter, &#39;total_bill&#39;, &#39;tip&#39;, edgecolor =&#39;w&#39;); Gli stili, le linee etc creo quindi un dizionario, in cui ci sono i parametri, lo chiamo kws costruisco una Griglia faccettata (FacedGrid), in cui: le colonne sono i valori di ‘sex’ punti che corrispondono a fumatori e non fumatori sono in colori diversi hue=’smoker’ altezza = 4 height=4 aspect = 1.3 (non ricordo cosa faccia) a questo punto mappo la funzione plt.scatter sulla griglia faccettata, tramite map. Alla funzione map passo 3 parametri: le x che sono ‘total_bill’ le y che e’ ‘tip’ kws sintassi strana devo mettere due asterischi *, davanti al dizionario quando lo passo! Ho trovato che non gli piace il fatto che definisca le colonne della FacetGrid tramite la variabile ‘sex’, forse perche’ e’ categorica? se metto time funge. Ho trovato l’errore. Io non penso in modo “case sensitive”, nell’esempio si mette hue_order=[&#39;yes&#39;, &#39;No&#39;], io invece avevo preso tutto in minuscolo. Per questo non scriveva nulla: non c’era corrispondenza tra: i valori dello hue: Yes,No i valori dello hue_order: yes, no Attento devi controllare che negli argomenti ci sia perfetta corrispondenza tra i nomi! Domanda cosa fanno i doppi asterischi davanti al dizinoario? Risposta fa un-packing dell’oggetto. kws = dict(s=50, linewidth=0.5, edgecolor =&#39;w&#39;) # ho creato un dizionario con 3 ingressi tips_fg = sns.FacetGrid(tips_df, col =&#39;sex&#39;, hue=&#39;smoker&#39;, height=4, aspect=1.3, hue_order=[&#39;Yes&#39;, &#39;No&#39;], hue_kws=dict(marker=[&#39;^&#39;,&#39;v&#39;])) # triangolini in su e triangolini in giu&#39; tips_fg.map(plt.scatter, &#39;total_bill&#39;, &#39;tip&#39;, **kws); # nota sintattica, qui gli passo ** Altro dataset: attention Ho degli studenti, ne voglio mettere 5 per linea. Per fare questo indico solo quale sia la variabile che uso per le colonne Poi tramite col_warps=5 indico che devono esserci solo 5 colonne al max, poi va a capo lui automaticamente numero di colonne per linea col_wrap=5 se non uso col_wrap=5 lui mette ogni valore di subject in una colonna diversa, ce ne sono 20… att_df = sns.load_dataset(&#39;attention&#39;) att_fg = sns.FacetGrid(att_df, col=&#39;subject&#39;) att_fg.map(plt.plot, &#39;solutions&#39;, &#39;score&#39;, marker=&#39;.&#39;) &lt;seaborn.axisgrid.FacetGrid at 0x122692041f0&gt; att_fg = sns.FacetGrid(att_df, col=&#39;subject&#39;, col_wrap=5, height=1.5) att_fg.map(plt.plot, &#39;solutions&#39;, &#39;score&#39;, marker=&#39;.&#39;) &lt;seaborn.axisgrid.FacetGrid at 0x1226863a4f0&gt; att_df.head(3) Unnamed: 0 subject attention solutions score 0 0 1 divided 1 2.0 1 1 2 divided 1 3.0 2 2 3 divided 1 3.0 Regression Plots Uso tip data, faccio uno scatter plot con interpolazione. lmplot() (linear regression?) Faccio due interpolazioni diverse per ognuno delle differenti hue plt.figure(figsize= (8,6)) sns.set_context(&#39;paper&#39;, font_scale=1.4) sns.lmplot(x=&#39;total_bill&#39;, y=&#39;tip&#39;, hue=&#39;sex&#39;, data = tips_df, markers=[&#39;o&#39;, &#39;^&#39;], scatter_kws={&#39;s&#39;:100, &#39;linewidth&#39;:0.5, &#39;edgecolor&#39;:&#39;w&#39;}); # regression plot &lt;Figure size 576x432 with 0 Axes&gt; Qui sotto usa i comandi col e row per costruire una sorta di FacetGrid automatica, tramite la funzione lmlpot (che fa la regressione). Anche in questo caso viene costruita una griglia. Questa griglia seleziona i punti e poi per i punti che hanno le caratteristiche che combaciano con quelle della griglia si fa il regression plot sns.lmplot(x=&#39;total_bill&#39;, y=&#39;tip&#39;, col=&#39;sex&#39;, row=&#39;time&#39;, data=tips_df); Salvare le figure Per salvare i file si usano semplicemente le funzioni di Matplotlib. In praticolare si deve: chiamare una funzione che faccia un’immagine subito dopo chiamare plt.savefig(&#39;nomeImmagine.eps&#39;) cambiando l’estensione si ottengono file diversi, per esempio png, pdf,... sns.lmplot(x=&#39;total_bill&#39;, y=&#39;tip&#39;, col=&#39;sex&#39;, row=&#39;time&#39;, data=tips_df); plt.savefig(&#39;prova.pdf&#39;) Subplots (Matplotlib) questo e’ piu’ correlato con matplotlib, comunque e’ utile anche in questo notebook. #import pandas as pd #import seaborn as sns #from matplotlib import pyplot as plt pokemon = pd.read_csv(&#39;pokemon.csv&#39;) #p_df.head() # bulbasaur = pokemon[[&#39;Name&#39;, &#39;HP&#39;, &#39;Attack&#39;, &#39;Defense&#39;, &#39;Sp. Atk&#39;, &#39;Sp. Def&#39;, &#39;Speed&#39;]][pokemon.loc[:, &#39;Name&#39;] == &#39;Bulbasaur&#39;] poke_num = pokemon[[&#39;Name&#39;, &#39;HP&#39;, &#39;Attack&#39;, &#39;Defense&#39;, &#39;Sp. Atk&#39;, &#39;Sp. Def&#39;, &#39;Speed&#39;]].set_index(&#39;Name&#39;) bulbasaur = poke_num.loc[&#39;Bulbasaur&#39;] charmander = poke_num.loc[&#39;Charmander&#39;] squirtle = poke_num.loc[&#39;Squirtle&#39;] fig, axes = plt.subplots(1, 3, figsize=(15, 5), sharey=True) fig.suptitle(&#39;Initial Pokemon - 1st Generation&#39;) # Bulbasaur sns.barplot(ax=axes[0], x=bulbasaur.index, y=bulbasaur.values) axes[0].set_title(bulbasaur.name) # Charmander sns.barplot(ax=axes[1], x=charmander.index, y=charmander.values) axes[1].set_title(charmander.name) # Squirtle sns.barplot(ax=axes[2], x=squirtle.index, y=squirtle.values) axes[2].set_title(squirtle.name) Text(0.5, 1.0, &#39;Squirtle&#39;) tips_df = sns.load_dataset(&#39;tips&#39;) #fig, axes =plt.subplots(1,3, figsize=(15,5), sharey=True) fig, axes =plt.subplots(1,3, figsize=(15,5)) sns.stripplot( ax=axes[0] ,x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, palette=&#39;magma&#39;) # FUNGE sns.stripplot( ax=axes[1], x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, palette=&#39;PuOr&#39;) # FUNGE sns.stripplot( ax=axes[2], x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, palette=&#39;winter&#39;) # FUNGE #sns.stripplot( x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df) # NON FUNGE #sns.stripplot( x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True) # NON FUNGE #sns.stripplot( x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True) # NON FUNGE &lt;AxesSubplot:xlabel=&#39;day&#39;, ylabel=&#39;total_bill&#39;&gt;" />
<meta property="og:description" content="Seaborn: Questi appunti contengono esempi, commenti e grafici basati sul bel video di Derek Banas di Simplilearn. Qualunque errore e’ dovuto a me e non da imputare a Derek Banas. Ho aggiunto anche pensieri e esempi che mi servivano. In alcuni casi i comandi indicati da Banas mi davano problemi, probabilmente per le versioni di Python/Matplotlib/Seaborn. Ho cercato di farli girare con dei piccoli cambiamenti. La mia versione e’ basata su una Anaconda aggiornata al Novembre 2020, all’interno di un Jupyter notebook. Alle volte faccio dei paragoni con Gnuplot, dato che e’ il mio sistema di visualizzazione di base… E’ capitato che facessi degli errori banali, ho lasciato le note sulle soluzioni perche’ possono essere utili. Introduzione: Seaborn e’ una libreria che lavora su Matplotlib e Pandas. Visto che un DataFrame di Pandas ha molte colonne, spesso sara’ necessario fare dei grafici multipli che contengano informazioni di tutte le coppie di colonne. In questo senso si puo’ vedere Seaborn come una serie di script che forniscono delle combinazioni di comandi che rendono veloce e semplice le visualizzazioni multiple (per progetti di data science). Alternativamente a Matplotlib esiste un’altra libreria chiamata bokeh (che esplorero’ in seguito) Trucco utilissimo (che non conoscevo/ricordavo) di Jupyter notebook cliccki su una cella clicchi su una funzione premi shift-tab: ti fa vedere tutti gli argomenti che possono essere passati a quella funzione Quando mi riferisco alle funzioni di Seaborn, non parlo di metodi associati ai DataFrame. La sola differenza e’ che non si applicano tramite la dot “notation” dei metodi. Il DataFrame (o sue parti) e’ passato come argomenti delle funzioni stesse. Inoltre ci possono essere altri argomenti utili, come per esempio: hue (assegna colori diversi a valori diversi, p.es. maschi e femmine) palette (sono combinazioni di colori, in cui viene definita una topologia di colori, per esemppio il successivo a questo rosso e’ quest’altro rosso…) styling (per cambiare la dimensione delle label..) set_style (cambia lo sfondo) non funge (forse perche’ faccio girare la cella dopo averne fatta girare un’altra che ha lasciato qualcosa in memoria) font_scale (grandezza delle label) spine (gli assi, laterali e verticali) ATTENTO: va messo sotto il comando sns.joinplot figsize (indica l’aspect ratio del rettangolo, base e poi altezza). ATTENTO, in jupyter puoi chiedere che matplotlib sia inline, questo fa si’ che le figure siano dei png sul notebook, e si puo’ definire un dpi. Questo ultimo comando “fissa” la dimensione visibile della figura! spine sono gli assi! legend (la legenda) jitter (per fare uno spredout dei punti in alcuni tipi di plot) side by side ( per mettere 2 figure di seaborn una da parte all’altra cerca: subplots) palettes (cerca la lista: maplotlib colormaps https://matplotlib.org/3.3.3/tutorials/colors/colormaps.html ) pivot tables (per fare le matrici, definisci le righe e le colonne. Questo seleziona dei valori. Tipicamente per questi valori esistono varie righe del DataFrame, da cui posso estrarre un grafico per ognuna delle righe e colonne della pivot table.) In prarica una pivot table fa un prodotto cartesiano tra tutti gli elementi delle righe e delle colonne. Subplot figure una di lato all’altra,o meglio all’interno di una “griglia” dove ci possono essere tanti grafici. Attento devi mettere il seguente con seaborn, che non c’e’ nel video di Banas: ax=axes[0] # per il primo ax=axes[1] # per il secondo oggetto. Se non li metti il sistema non fa vedere la prima figura ma disegna un plot vuoto e fa vedere da parte l’ultimo plot disegnato. Ho trovato l’esempio con i pokemon (sebbene la pagina sia poco leggibile): https://dev.to/thalesbruno/subplotting-with-matplotlib-and-seaborn-5ei8 TRUCCO ci sono vari magic command di Matplotlib oltre al solito inline: %matplotlib inline - Figures are shown as static png images (optionally svg if configured) %matplotlib notebook or %matplotlib nbagg - Interactive Figures inside the notebook %matplotlib widgets - - Interactive Figures inside the notebook (requires jupyter-matplotlib to be installed) %matplotlib tk or Nota tecnica: Ho notato che una TOC poteva risultare utile, per questo ho installato jupyter-navbar. Ho semplicemente scaricato lo zip da https://github.com/shoval/jupyter-navbar e (dopo avere decompresso) ho fatto girare da Babun con python2.7 il file setup.py (questo perche’ lo sto facendo girare in Windows 10). In questo modo appare la barra con l’indice. import numpy as np import pandas as pd import matplotlib.pyplot as plt import seaborn as sns #sns.set() %matplotlib inline #%matplotlib notebook #%matplotlib tk #%matplotlib widgets # questi sotto non so ancora cosa facciano %reload_ext autoreload %autoreload 2 #cs_df = pd.read_csv(&#39;ComputerSales.csv&#39;) # dovrei trovarlo Dataset di Seaborn posso sapere la lista di questi dataset e anche caricarli velocemente con il metodo load_dataset print (sns.get_dataset_names()) [&#39;anagrams&#39;, &#39;anscombe&#39;, &#39;attention&#39;, &#39;brain_networks&#39;, &#39;car_crashes&#39;, &#39;diamonds&#39;, &#39;dots&#39;, &#39;exercise&#39;, &#39;flights&#39;, &#39;fmri&#39;, &#39;gammas&#39;, &#39;geyser&#39;, &#39;iris&#39;, &#39;mpg&#39;, &#39;penguins&#39;, &#39;planets&#39;, &#39;tips&#39;, &#39;titanic&#39;] crash_df = sns.load_dataset(&#39;car_crashes&#39;) print(crash_df.shape) print(crash_df.head(3)) (51, 8) total speeding alcohol not_distracted no_previous ins_premium \ 0 18.8 7.332 5.640 18.048 15.040 784.55 1 18.1 7.421 4.525 16.290 17.014 1053.48 2 18.6 6.510 5.208 15.624 17.856 899.47 ins_losses abbrev 0 145.08 AL 1 133.93 AK 2 110.35 AZ Distribution Plots Distribution Plot sns.distplot(miaSerie): questa funzione, in pratica, se applicata ad una Series di Pandas produce automaticamente un istogramma. Occhio che il comando qui sotto e’ deprecato, e verra rimosso in futuro. Non e’ chiaro perche’, ma nelle note del “warning” di python indicano di usare una funzione con lo stesso nome: distplot ma che e’ “a figure-level function”, oppure: histplot Questa funzione in ogni modo fa un istogramma di una colonna (Series) di un dataframe di Pandas. Inoltre per default fa anche un kernel density estimation (KDE), possiamo spegnerlo con kde=False bins e’ il numero di bin dell’immagine, non la loro larghezza (ovviamente visto che ha una s…) sns.distplot(crash_df[&#39;not_distracted&#39;], kde=False, bins=15) C:\ProgramData\Anaconda3\lib\site-packages\seaborn\distributions.py:2551: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms). warnings.warn(msg, FutureWarning) &lt;AxesSubplot:xlabel=&#39;not_distracted&#39;&gt; Joint Plots La funzione: sns.jointplot costruisce uno scatterplot con “aggiunte”. viene fatto per paragonare 2 distribuzioni diverse (che saranno 2 colonne di un DataFrame). In pratica fa un scatter plot, e sopra e sotto mette anche gli istogrammi relativi alle colonne. inolte si puo’ aggiungere al volo una regressione lineare con il comando kind=&#39;reg&#39; nello scatterplot e i kernel sopra gli istogrammi. il comando kind definisce lo stile di visualizzazione. vanno passate delle x e delle y in forma di Series che costituiranno le coordinate dei punti dello scatterplot. Ovviamente il numero di oggetti delle x e delle y deve essere lo stesso, altrimenti per un punto ci sarebbe solo una coordinata ma non la seconda… sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df, kind =&#39;reg&#39; ); sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df ); # ho tolto la curva con il kernel estimation e la regressione Attenzione che il grafo nel video non ha solo le isoipse ma anche un sistema di colorazione che in qui sotto non appare! sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df, kind= &#39;kde&#39; ); sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df, kind= &#39;hex&#39; ); KDE plot La funzione Kdeplot costruisce una sorta di interpolazione dei dati di una series. nota che nel grafico sotto non appare la legenda, mentre nel video c’e’ di default! sns.kdeplot(crash_df[&#39;alcohol&#39;]); Pair Plot Fa vedere la relazione tra tutte le coppi di colonne contenenti valori numerici dell’intero DataFrame. Esclude i valori categorici Occhio che e’ lento! Anche in questo caso il comando kind=... definisce come viene visualizzato lo scatterplot. Nell’esempio sotto solo le isoipse. sns.pairplot(crash_df, kind = &#39;kde&#39;); # nel video fa anche i colori e non solo le linee di livello Pairplot Hue hue assegna un colore diverso a tutti i valori della colonna indicata. Per esmepio in questo caso hue=’sex’, quindi i punti associati a Male e Female sono colorati in modo diverso. In pratica lui va a prendere i dati, li divide per sesso, poi li disegna automaticamente sullo stesso grafico ma con colori diversi! Nota: si puo’ usare anche con variabili categoriche, non solo le variabili numeriche (anzi penso che possa avere dei problemi se le variabili numeriche sono float…) tips_df = sns.load_dataset(&#39;tips&#39;) print(tips_df.head(3)) sns.pairplot(tips_df, hue=&#39;sex&#39;, palette=&#39;Blues&#39;); # occhio che qui c&#39;e&#39; il sesso del pagante non del ricevente... total_bill tip sex smoker day time size 0 16.99 1.01 Female No Sun Dinner 2 1 10.34 1.66 Male No Sun Dinner 3 2 21.01 3.50 Male No Sun Dinner 3 Rug plot Questo tipo di grafico fa vedere delle lineette per ogni punto. In pratica fa un unfolding di un istogramma. sns.rugplot(tips_df[&#39;tip&#39;]); Styling serve per modificare l’aspetto delle figure Problema, se cambio i parametri di figsize, mi restituisce un “Figure size 576x864 with 0 Axes”, e i valori contenuti sono coerenti coi parametri che ho dato… ma il grafico non viene modificato! Forse il problema e’ legato all’inline lanciato all’inizio mentre in un eventuale salvataggio a file otterrei dei risultati differenti? spine e’ il termine tecnico associato agli assi. Se per esempio non voglio che uno degli assi appaia nel grafico posso usare la funzione despine. Attenzione che va messo sotto il comando del disegno joinplot altrimenti non ha effetto! set_context modifica i parametri in modo che la dimensione dei font e del grafico siano proporzionati in base al contesto. Per esempio se faccio un poster ho bisogno di label grandi… set_style sono le combinazioni di colori dello sfondo #sns.set_style (&#39;white&#39;) sns.set_style (&#39;darkgrid&#39;) #sns.set_style (&#39;whitegrid&#39;) #sns.set_style (&#39;ticks&#39;) plt.figure(figsize=(8,5)) # non funge, devo capire perche&#39;! sns.set_context(&#39;paper&#39;, font_scale=1.5) #sns.set_context(&#39;talk&#39;, font_scale=1.5) # ingrandisce tutto #sns.set_context(&#39;poster&#39;, font_scale=1.5) sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data= crash_df, kind=&#39;reg&#39;); sns.despine(left=True, right=False, top=True, bottom=False) # Occhio va messo SOTTO joinplot altrimenti non fa nulla &lt;Figure size 576x360 with 0 Axes&gt; Categorical Plotting Bar Plots barplot() di default fa vedere la mean La barra nera fa vedre la varianza devo passare cosa ci sia sulle x e sulle y (e il dataframe da cui sono prese) sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df); Possiamo usare funzioni diverse per stimare i valori categorici, per esempio tutti quelli in numpy, come la mediana, o la moda (non mi e’ riuscito)! Attento se fai 2 barplot, li sovrappone e non si capisce nulla Si possono usare delle funzioni custom fatte da noi, suppongo che di base si debba lavorare con un oggetto di tipo Series di Pandas #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.median); # mediana #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.std); # deviazione standard #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.var); # varianza sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.cov); # covarianza #from scipy.stats import mode # non sono riuscito a fargli usare la moda #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=mode); Count Plot countplot e’ come un barplot ma l’estimatore conta solo il numero di occorrenze, per questo non ha bisogno della y (e’ automaticamente il numero di occorrenze) sns.countplot(x=&#39;sex&#39;, data=tips_df) &lt;AxesSubplot:xlabel=&#39;sex&#39;, ylabel=&#39;count&#39;&gt; Box Plot boxplot() fa vedere il grafico a baffi con i quartili dei dati. la linea nera e’ la mean la scatola si estende di una deviazione standard (siamo sicuri? calcola la deviazione standard destra e sinistra? Di solito (wikipedia) la scatola indica il primo e il terzo quartile, devo controllare). I whiskers (baffi) si estendono fino ??? .In alcune rappresentazioni si estendono fino al massimo e al minimo I punti sono outliers (che non stanno nei baffi). Non e’ spiegato bene nella documentazione di Seaborn. Se usano la convenzione per gli outlier che uso io e’ Q3 + 3 IQ (dove l’interquartile e’ la differenza tra il terzo e il primo quartile IQ= Q3-Q1). sulle x vengono selezionati vari insiemi di dati sulle y viene fatto il grafico a baffi di quei particolari dati (vedi il grafico che e’ chiaro) L’estensione dei whisker non viene spiegata bene nelle note di Seaborn. sns.boxplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); plt.legend(loc=1); # la legenda in alto a sx e&#39; loc =0 Violin Plot Una combinazione di boxplot e kde plot, dove usa i kernel. Il nome e’ ovvio… sns.violinplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); # E&#39; inutile mettere tutto il violino per una sola categoria, mettiamo mezzo per una e mezzo per l&#39;altra: split sns.violinplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;,split=True); Strip plot stripplot() si usa quando una variabile e’ categorica: jitter non mi pare che faccia una grande differenza, dovrebbe sparpagliare meglio i punti hue funziona assegna dei colori diversi in base ad una variabile categorica dodge, separa fisicamente i punti con hue differente Prima non disegnava correttamente, perche’ dove avevo scritto fig, ax= plt.subplots(1,2, figsize=(15,5)) avrei invece dovuto scrivere ‘fig, axes=…’ ###### HO fatto qualche modifica rispetto al video, in modo da paragonare con e senza jitter ##### #plt.figure(figsize=(8,5)) fig, axes =plt.subplots(1,2 ,figsize=(15, 5) ) # grafici uno da parte all&#39;altro sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, ax=axes[0]); sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, ax=axes[1], jitter=True); #fig.show() # non serve in un jupyter notebook sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True); # jitter muove un po&#39; in giro i punti sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, hue=&#39;sex&#39;); Separo le hue, ma le lascio allo stesso giorno. Questo viene ottenuto tramite il comando dodge separa fisicamente i due gruppi di punti. sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, hue=&#39;sex&#39;, dodge=True); Swarm plot (lo sciame) violinplot() combina i plot precedenti. in pratica definisce la posizione dei punti come se fossero delle foglie, il primo al centro poi un a dx in alto , sx in alto.. Prima riguardiamo il violino (poi lo confrontiamo con lo swarmplot) sns.violinplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df); # poi vediamo lo sciame. sns.swarmplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df); # metto insieme il violino e lo sciame sns.violinplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df); sns.swarmplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df, color=&#39;white&#39;); Palettes palette e’ un parametro una palette e’ un insieme di colori predefiniti. in cui definiamo anche una topologia tra colori: ovvero quale colore e’ vicino a quale colore. punto di partenza una palette standard Le palette si trovano qui: https://matplotlib.org/3.3.3/tutorials/colors/colormaps.html ) plt.figure(figsize=(8,5)) # funge! se non lo metto sotto diventa tutto piu&#39; piccolo sns.set_style(&#39;dark&#39;) sns.set_context(&#39;talk&#39;) sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); cambio palette plt.figure(figsize=(8,5)) sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;, palette=&#39;PuBu&#39;); # PuBu=palette trovata su matplotlib Legend qualche comando per muovere la legenda. In teoria: loc = 0 sceglie lui la posizione ottimale upper right=1 upper left =2 lower left =3 lower right =4 Cerca Matplotib legends e ci sono tutte le opzioni https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.legend.html #plt.figure(figsize=(8,5)) # funge! se non lo metto sotto diventa tutto piu&#39; piccolo plt.figure(figsize=(8,7)) # funge! se non lo metto sotto diventa tutto piu&#39; piccolo sns.set_style(&#39;dark&#39;) sns.set_context(&#39;talk&#39;) sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); #plt.legend(loc=0) # best = sceglie lui la posizione #plt.legend(loc=1) # in alto a dx #plt.legend(loc=2) # in alto a sx #plt.legend(loc=3) # in basso a sx plt.legend(loc=4) # in basso a dx &lt;matplotlib.legend.Legend at 0x12265a93550&gt; Matrix Plot In questo caso vogliamo visualizzare una matrice, ovvero un oggetto con righe e colonne. In ogni ingresso della matrice avro’ dei valori e voglio visualizzarli. Heatmaps heatmap() qui sotto prendiamo il crash_df e cerchiamo di costruire delle heatmaps argomenti utili: cmap = ‘Blues’ e’ la colormap annot =True scrivi anche il valore della colorazione nella casella (altrimenti fa solo il colore) crash_df.head(3); # riguardiamo questo df Qui sotto uso un metodo (di Pandas?) per cui dato un dataframe con valori numerici e categorici calcola la correlazione tra ogni coppia di colonne numeriche crash_mx = crash_df.corr() crash_mx.head(3) total speeding alcohol not_distracted no_previous ins_premium ins_losses total 1.000000 0.611548 0.852613 0.827560 0.956179 -0.199702 -0.036011 speeding 0.611548 1.000000 0.669719 0.588010 0.571976 -0.077675 -0.065928 alcohol 0.852613 0.669719 1.000000 0.732816 0.783520 -0.170612 -0.112547 plt.figure(figsize=(8,6)) sns.set_context(&#39;paper&#39;, font_scale=1.4) #sns.heatmap(crash_mx, annot=True, cmap=&#39;Blues&#39;) # fa vedere anche i numeri nelle caselle colorate sns.heatmap(crash_mx, annot=False, cmap=&#39;magma&#39;) # fa vedere SOLO i colori &lt;AxesSubplot:&gt; Pivot Table questo e’ un altro modo per costruire una matrice. NEll’esempio sotto quello che fa e’: indico l’index ovvero l’attributo che viene usato per l’indice di riga indico le columns, ovvero l’attributo che viene usato per l’indice di colonna A questo punto lui va. Controlla tutti gli i valori dell’attributo per l’index. Li usa per costruire una tabelle di cui sono tutte le righe. Poi va e controlla i valori dell’attributo per le columns e costruisce le colonne. Poi va e pesca per ognuno degli attributi dell’index e delle columns i valori dati come values e li mette nelle caselle. flights = sns.load_dataset(&#39;flights&#39;) flights.head(3) year month passengers 0 1949 Jan 112 1 1949 Feb 118 2 1949 Mar 132 flights.pivot_table(index=&#39;month&#39;, columns=&#39;year&#39;, values=&#39;passengers&#39;) # NON lavora INPLACE (invece nel video si&#39;) flights_pt = flights.pivot_table(index=&#39;month&#39;, columns=&#39;year&#39;, values=&#39;passengers&#39;) #sns.heatmap(flights.pivot_table(index=&#39;month&#39;, columns=&#39;year&#39;, values=&#39;passengers&#39;), annot=False, cmap=&#39;Blues&#39;) # IDENTICO fig, axes = plt.subplots(1, 2, figsize=(12, 5), sharey=True) sns.heatmap (flights_pt, ax=axes[0],annot=False, cmap=&#39;Blues&#39;) sns.heatmap (flights_pt, ax=axes[1],annot=False, cmap=&#39;Blues&#39;, linecolor=&#39;white&#39;, linewidth=1) ; #larghezza linea default 0? Cluster Map clustermap() hierarchically clusterd heatmap = heatmap ottenuta cone una clusterizzazione gerarchica la distanza tra tutti i punti e’ calcolata i piu’ vicini sono uniti il lavoro continua con il prossimo vicino quindi paragona le colonne e le righe A differenza della heatmap, dove l’ordine degli attributi e’ mantenuto costante, in questo caso viene riordinato seguendo il clustering. iris = sns.load_dataset(&#39;iris&#39;) # e&#39; un pandas dataframe di default iris.head(3) #sns.clustermap(iris) sepal_length sepal_width petal_length petal_width species 0 5.1 3.5 1.4 0.2 setosa 1 4.9 3.0 1.4 0.2 setosa 2 4.7 3.2 1.3 0.2 setosa species = iris.pop(&#39;species&#39;) # pop spara fuori una colonna e la trasforma in una Series Heatmap ottenuta con una clusterizzazione gerarchica sns.clustermap(iris); # heatmap ottenuta con una clusterizzazione gerarchica Ricorda che la pivot table ho dovuto rinominarla, per lui fights e’ la pivot table, per me e’ flights_pt #sns.clustermap(flights , cmap =&#39;Blues&#39;, standard_scale =1) # NON FUNGE normalizza i dati per focalizzarci sul clustering sns.clustermap(flights_pt , cmap =&#39;Blues&#39;, standard_scale =1); # normalizza i dati per focalizzarci sul clustering un commento a quanto qui sopra. Pensale in termine di sequenze numeriche, in cui il colore e’ un numero. Puoi avere sequenze verticali e orizzontali. Prendiamo ora le sequenze orizzontali. Le due piu’ in alto sono molto chiare, ma non sono le piu’ vicine, infatti Nov e Jan sono connesse. Poi si connette Feb. Non mi e’ chiaro il dendrogramma come venga poi costruito. Mi pare di capire che alla fine ci possano essere solo delle coppie. Se il primo vicino di una sequenza e’ gia’ in una coppia, questa rimane isolata e va attaccata alla coppia oppure… devo pensare all’algoritmo. Nota che a causa del clustering mi aspetto di vedere striscie. Questo perche’ sequenze simili vanno messe vicine tra loro. Potrebbero mettere un puntino al centro di ogni cella. Questo punto si puo’ muovere sull’asse delle z o delle y .Il modvimento e’ lo stesso sui due assi e in questo modo si vedono le sequenze sia guardando le righe che le colonne! Pair Grids PairGrid() Prima abbiamo visto i pairplots, dove si facevano degli scatter plot tra tutte le coppie di colonne del DataFrame. Per prima cosa creiamo una grid vuota. iris = sns.load_dataset(&#39;iris&#39;) iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie iris_g.map(plt.scatter); # questo mi pare un comando di matplotlib o PANDAS Ora vogliamo mettere un istogramma lungo la diagonale (della griglia di grafici). iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie #iris_g.map(plt.scatter); # questo mi pare un comando di matplotlib o PANDAS iris_g.map_diag(plt.hist); # nei grafi diagonali inserisce un istogramma iris_g.map_offdiag(plt.scatter); # non mette gli scatterplot diagonali! (occhio che devi commentare l&#39;altro!) Ora vogliamo mettere delle altre cose nella: parte superiore (della matrice di grafici) parte inferiore (della matrice di grafici) quindi diamo un comando chen indica cosa mettere sulla diagonale e poi uno per la triangolare superiore e uno per la triangoplar e superiore. Occhio che si deve passare come argomento di map_diag (oppure map_lower o map_upper) il nome della funzione che si userebbe per diegnare un singolo plot di questo tipo. iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie iris_g.map_diag(plt.hist); # nei grafi diagonali inserisce un istogramma iris_g.map_upper(plt.scatter); # sopre metti gli scatter plot iris_g.map_lower(sns.kdeplot); # sotto metti KDE quindi devi usare la funzione di SEABORN Variabili per la nostra custom grid #iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie iris_g = sns.PairGrid(iris, hue=&#39;species&#39;, x_vars=[&quot;sepal_length&quot;, &quot;sepal_width&quot;], y_vars= [&quot;petal_length&quot;, &quot;petal_width&quot;] ) iris_g.map(plt.scatter); # map e&#39; usata in modo molto potente iris_g.add_legend(); Facet Grid FacetGrid() E’ una specie di subplots di matplotlib ma con delle cose predefinite. posso disegnare plot multipli in una griglia (grid) posso definire le colonne e righe Si crea un sistema a forma di griglia (in cui pero’ non abbiamo ancora messo nulla). Al primo passo indico le colonne e le righe, per esempio: nelle colonne metto il tempo (time). Che puo’ assumere 2 valori: Dinner e Lunch nelle righe metto ‘smoker’. Che puo’ assumere 2 valori: yes e no Quindi la griglia che ho creato e’ 2x2. In ogni ingresso della griglia devo mettere un grafico. Cosa metto? Map Il metodo map() di python e’ utilissimo perche’ posso passare anche delle funzioni! Mappo ogni grafo con il metodo map() e faccio un istogramma della quantita’ ‘total_bill’. Queste quantita’ saranno limitata al valore di ‘time’ e ‘smoker’ corrispondente alla griglia! Quindi per esempio in alto a sx: smoker = yes time = lunch Faccio l’istogramma di tutti i ‘total_bill’ che si riferiscono a smoker e lunch. Ricapitolando con FacetGrid definisco una griglia associata a due colonne, che formeranno le righe e le colonne della griglia. Per ogni valore di ciascuna delle due colonne faccio un grafico riferito, ad una terza colonna tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) # qui resta vuota. sns.set_context(&#39;paper&#39;, font_scale=1.5) tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) tips_fg.map(plt.hist, &#39;total_bill&#39;, bins=8 ); # mappa la funzione plt.hist, sulla quantita &#39;total_bill&#39; tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) tips_fg.map(plt.hist, &#39;day&#39; ) &lt;seaborn.axisgrid.FacetGrid at 0x122685a3ac0&gt; tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) tips_fg.map(plt.scatter, &#39;total_bill&#39;, &#39;tip&#39;); Nel caso sotto invece, facciamo una griglia che contiene solo colonne. Non ci sono righe, pero’ adesso usiamo il comando hue che ci permette di usare un colore diverso in base all’argomento usato. In questo caso uso come hue=’smoker’ Aggiungo un prametro, col_order che mi consente di ordinare le colonne. Basta mettere una lista contenente il nome delle colonne volute e l’ordine di quella lista sara’ seguito dal plot. tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, hue=&#39;smoker&#39;, height=4, aspect=1.3, col_order=[&#39;Dinner&#39;,&#39;Lunch&#39;] , palette=&#39;Set1&#39;) tips_fg.map(plt.scatter, &#39;total_bill&#39;, &#39;tip&#39;, edgecolor =&#39;w&#39;); Gli stili, le linee etc creo quindi un dizionario, in cui ci sono i parametri, lo chiamo kws costruisco una Griglia faccettata (FacedGrid), in cui: le colonne sono i valori di ‘sex’ punti che corrispondono a fumatori e non fumatori sono in colori diversi hue=’smoker’ altezza = 4 height=4 aspect = 1.3 (non ricordo cosa faccia) a questo punto mappo la funzione plt.scatter sulla griglia faccettata, tramite map. Alla funzione map passo 3 parametri: le x che sono ‘total_bill’ le y che e’ ‘tip’ kws sintassi strana devo mettere due asterischi *, davanti al dizionario quando lo passo! Ho trovato che non gli piace il fatto che definisca le colonne della FacetGrid tramite la variabile ‘sex’, forse perche’ e’ categorica? se metto time funge. Ho trovato l’errore. Io non penso in modo “case sensitive”, nell’esempio si mette hue_order=[&#39;yes&#39;, &#39;No&#39;], io invece avevo preso tutto in minuscolo. Per questo non scriveva nulla: non c’era corrispondenza tra: i valori dello hue: Yes,No i valori dello hue_order: yes, no Attento devi controllare che negli argomenti ci sia perfetta corrispondenza tra i nomi! Domanda cosa fanno i doppi asterischi davanti al dizinoario? Risposta fa un-packing dell’oggetto. kws = dict(s=50, linewidth=0.5, edgecolor =&#39;w&#39;) # ho creato un dizionario con 3 ingressi tips_fg = sns.FacetGrid(tips_df, col =&#39;sex&#39;, hue=&#39;smoker&#39;, height=4, aspect=1.3, hue_order=[&#39;Yes&#39;, &#39;No&#39;], hue_kws=dict(marker=[&#39;^&#39;,&#39;v&#39;])) # triangolini in su e triangolini in giu&#39; tips_fg.map(plt.scatter, &#39;total_bill&#39;, &#39;tip&#39;, **kws); # nota sintattica, qui gli passo ** Altro dataset: attention Ho degli studenti, ne voglio mettere 5 per linea. Per fare questo indico solo quale sia la variabile che uso per le colonne Poi tramite col_warps=5 indico che devono esserci solo 5 colonne al max, poi va a capo lui automaticamente numero di colonne per linea col_wrap=5 se non uso col_wrap=5 lui mette ogni valore di subject in una colonna diversa, ce ne sono 20… att_df = sns.load_dataset(&#39;attention&#39;) att_fg = sns.FacetGrid(att_df, col=&#39;subject&#39;) att_fg.map(plt.plot, &#39;solutions&#39;, &#39;score&#39;, marker=&#39;.&#39;) &lt;seaborn.axisgrid.FacetGrid at 0x122692041f0&gt; att_fg = sns.FacetGrid(att_df, col=&#39;subject&#39;, col_wrap=5, height=1.5) att_fg.map(plt.plot, &#39;solutions&#39;, &#39;score&#39;, marker=&#39;.&#39;) &lt;seaborn.axisgrid.FacetGrid at 0x1226863a4f0&gt; att_df.head(3) Unnamed: 0 subject attention solutions score 0 0 1 divided 1 2.0 1 1 2 divided 1 3.0 2 2 3 divided 1 3.0 Regression Plots Uso tip data, faccio uno scatter plot con interpolazione. lmplot() (linear regression?) Faccio due interpolazioni diverse per ognuno delle differenti hue plt.figure(figsize= (8,6)) sns.set_context(&#39;paper&#39;, font_scale=1.4) sns.lmplot(x=&#39;total_bill&#39;, y=&#39;tip&#39;, hue=&#39;sex&#39;, data = tips_df, markers=[&#39;o&#39;, &#39;^&#39;], scatter_kws={&#39;s&#39;:100, &#39;linewidth&#39;:0.5, &#39;edgecolor&#39;:&#39;w&#39;}); # regression plot &lt;Figure size 576x432 with 0 Axes&gt; Qui sotto usa i comandi col e row per costruire una sorta di FacetGrid automatica, tramite la funzione lmlpot (che fa la regressione). Anche in questo caso viene costruita una griglia. Questa griglia seleziona i punti e poi per i punti che hanno le caratteristiche che combaciano con quelle della griglia si fa il regression plot sns.lmplot(x=&#39;total_bill&#39;, y=&#39;tip&#39;, col=&#39;sex&#39;, row=&#39;time&#39;, data=tips_df); Salvare le figure Per salvare i file si usano semplicemente le funzioni di Matplotlib. In praticolare si deve: chiamare una funzione che faccia un’immagine subito dopo chiamare plt.savefig(&#39;nomeImmagine.eps&#39;) cambiando l’estensione si ottengono file diversi, per esempio png, pdf,... sns.lmplot(x=&#39;total_bill&#39;, y=&#39;tip&#39;, col=&#39;sex&#39;, row=&#39;time&#39;, data=tips_df); plt.savefig(&#39;prova.pdf&#39;) Subplots (Matplotlib) questo e’ piu’ correlato con matplotlib, comunque e’ utile anche in questo notebook. #import pandas as pd #import seaborn as sns #from matplotlib import pyplot as plt pokemon = pd.read_csv(&#39;pokemon.csv&#39;) #p_df.head() # bulbasaur = pokemon[[&#39;Name&#39;, &#39;HP&#39;, &#39;Attack&#39;, &#39;Defense&#39;, &#39;Sp. Atk&#39;, &#39;Sp. Def&#39;, &#39;Speed&#39;]][pokemon.loc[:, &#39;Name&#39;] == &#39;Bulbasaur&#39;] poke_num = pokemon[[&#39;Name&#39;, &#39;HP&#39;, &#39;Attack&#39;, &#39;Defense&#39;, &#39;Sp. Atk&#39;, &#39;Sp. Def&#39;, &#39;Speed&#39;]].set_index(&#39;Name&#39;) bulbasaur = poke_num.loc[&#39;Bulbasaur&#39;] charmander = poke_num.loc[&#39;Charmander&#39;] squirtle = poke_num.loc[&#39;Squirtle&#39;] fig, axes = plt.subplots(1, 3, figsize=(15, 5), sharey=True) fig.suptitle(&#39;Initial Pokemon - 1st Generation&#39;) # Bulbasaur sns.barplot(ax=axes[0], x=bulbasaur.index, y=bulbasaur.values) axes[0].set_title(bulbasaur.name) # Charmander sns.barplot(ax=axes[1], x=charmander.index, y=charmander.values) axes[1].set_title(charmander.name) # Squirtle sns.barplot(ax=axes[2], x=squirtle.index, y=squirtle.values) axes[2].set_title(squirtle.name) Text(0.5, 1.0, &#39;Squirtle&#39;) tips_df = sns.load_dataset(&#39;tips&#39;) #fig, axes =plt.subplots(1,3, figsize=(15,5), sharey=True) fig, axes =plt.subplots(1,3, figsize=(15,5)) sns.stripplot( ax=axes[0] ,x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, palette=&#39;magma&#39;) # FUNGE sns.stripplot( ax=axes[1], x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, palette=&#39;PuOr&#39;) # FUNGE sns.stripplot( ax=axes[2], x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, palette=&#39;winter&#39;) # FUNGE #sns.stripplot( x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df) # NON FUNGE #sns.stripplot( x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True) # NON FUNGE #sns.stripplot( x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True) # NON FUNGE &lt;AxesSubplot:xlabel=&#39;day&#39;, ylabel=&#39;total_bill&#39;&gt;" />
<link rel="canonical" href="http://localhost:4000/Seaborn" />
<meta property="og:url" content="http://localhost:4000/Seaborn" />
<meta property="og:site_name" content="4Phycs" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-08T01:00:00+01:00" />
<meta name="google-site-verification" content="" />
<script type="application/ld+json">
{"headline":"Seaborn - appunti","dateModified":"2021-11-08T01:00:00+01:00","datePublished":"2021-11-08T01:00:00+01:00","description":"Seaborn: Questi appunti contengono esempi, commenti e grafici basati sul bel video di Derek Banas di Simplilearn. Qualunque errore e’ dovuto a me e non da imputare a Derek Banas. Ho aggiunto anche pensieri e esempi che mi servivano. In alcuni casi i comandi indicati da Banas mi davano problemi, probabilmente per le versioni di Python/Matplotlib/Seaborn. Ho cercato di farli girare con dei piccoli cambiamenti. La mia versione e’ basata su una Anaconda aggiornata al Novembre 2020, all’interno di un Jupyter notebook. Alle volte faccio dei paragoni con Gnuplot, dato che e’ il mio sistema di visualizzazione di base… E’ capitato che facessi degli errori banali, ho lasciato le note sulle soluzioni perche’ possono essere utili. Introduzione: Seaborn e’ una libreria che lavora su Matplotlib e Pandas. Visto che un DataFrame di Pandas ha molte colonne, spesso sara’ necessario fare dei grafici multipli che contengano informazioni di tutte le coppie di colonne. In questo senso si puo’ vedere Seaborn come una serie di script che forniscono delle combinazioni di comandi che rendono veloce e semplice le visualizzazioni multiple (per progetti di data science). Alternativamente a Matplotlib esiste un’altra libreria chiamata bokeh (che esplorero’ in seguito) Trucco utilissimo (che non conoscevo/ricordavo) di Jupyter notebook cliccki su una cella clicchi su una funzione premi shift-tab: ti fa vedere tutti gli argomenti che possono essere passati a quella funzione Quando mi riferisco alle funzioni di Seaborn, non parlo di metodi associati ai DataFrame. La sola differenza e’ che non si applicano tramite la dot “notation” dei metodi. Il DataFrame (o sue parti) e’ passato come argomenti delle funzioni stesse. Inoltre ci possono essere altri argomenti utili, come per esempio: hue (assegna colori diversi a valori diversi, p.es. maschi e femmine) palette (sono combinazioni di colori, in cui viene definita una topologia di colori, per esemppio il successivo a questo rosso e’ quest’altro rosso…) styling (per cambiare la dimensione delle label..) set_style (cambia lo sfondo) non funge (forse perche’ faccio girare la cella dopo averne fatta girare un’altra che ha lasciato qualcosa in memoria) font_scale (grandezza delle label) spine (gli assi, laterali e verticali) ATTENTO: va messo sotto il comando sns.joinplot figsize (indica l’aspect ratio del rettangolo, base e poi altezza). ATTENTO, in jupyter puoi chiedere che matplotlib sia inline, questo fa si’ che le figure siano dei png sul notebook, e si puo’ definire un dpi. Questo ultimo comando “fissa” la dimensione visibile della figura! spine sono gli assi! legend (la legenda) jitter (per fare uno spredout dei punti in alcuni tipi di plot) side by side ( per mettere 2 figure di seaborn una da parte all’altra cerca: subplots) palettes (cerca la lista: maplotlib colormaps https://matplotlib.org/3.3.3/tutorials/colors/colormaps.html ) pivot tables (per fare le matrici, definisci le righe e le colonne. Questo seleziona dei valori. Tipicamente per questi valori esistono varie righe del DataFrame, da cui posso estrarre un grafico per ognuna delle righe e colonne della pivot table.) In prarica una pivot table fa un prodotto cartesiano tra tutti gli elementi delle righe e delle colonne. Subplot figure una di lato all’altra,o meglio all’interno di una “griglia” dove ci possono essere tanti grafici. Attento devi mettere il seguente con seaborn, che non c’e’ nel video di Banas: ax=axes[0] # per il primo ax=axes[1] # per il secondo oggetto. Se non li metti il sistema non fa vedere la prima figura ma disegna un plot vuoto e fa vedere da parte l’ultimo plot disegnato. Ho trovato l’esempio con i pokemon (sebbene la pagina sia poco leggibile): https://dev.to/thalesbruno/subplotting-with-matplotlib-and-seaborn-5ei8 TRUCCO ci sono vari magic command di Matplotlib oltre al solito inline: %matplotlib inline - Figures are shown as static png images (optionally svg if configured) %matplotlib notebook or %matplotlib nbagg - Interactive Figures inside the notebook %matplotlib widgets - - Interactive Figures inside the notebook (requires jupyter-matplotlib to be installed) %matplotlib tk or Nota tecnica: Ho notato che una TOC poteva risultare utile, per questo ho installato jupyter-navbar. Ho semplicemente scaricato lo zip da https://github.com/shoval/jupyter-navbar e (dopo avere decompresso) ho fatto girare da Babun con python2.7 il file setup.py (questo perche’ lo sto facendo girare in Windows 10). In questo modo appare la barra con l’indice. import numpy as np import pandas as pd import matplotlib.pyplot as plt import seaborn as sns #sns.set() %matplotlib inline #%matplotlib notebook #%matplotlib tk #%matplotlib widgets # questi sotto non so ancora cosa facciano %reload_ext autoreload %autoreload 2 #cs_df = pd.read_csv(&#39;ComputerSales.csv&#39;) # dovrei trovarlo Dataset di Seaborn posso sapere la lista di questi dataset e anche caricarli velocemente con il metodo load_dataset print (sns.get_dataset_names()) [&#39;anagrams&#39;, &#39;anscombe&#39;, &#39;attention&#39;, &#39;brain_networks&#39;, &#39;car_crashes&#39;, &#39;diamonds&#39;, &#39;dots&#39;, &#39;exercise&#39;, &#39;flights&#39;, &#39;fmri&#39;, &#39;gammas&#39;, &#39;geyser&#39;, &#39;iris&#39;, &#39;mpg&#39;, &#39;penguins&#39;, &#39;planets&#39;, &#39;tips&#39;, &#39;titanic&#39;] crash_df = sns.load_dataset(&#39;car_crashes&#39;) print(crash_df.shape) print(crash_df.head(3)) (51, 8) total speeding alcohol not_distracted no_previous ins_premium \\ 0 18.8 7.332 5.640 18.048 15.040 784.55 1 18.1 7.421 4.525 16.290 17.014 1053.48 2 18.6 6.510 5.208 15.624 17.856 899.47 ins_losses abbrev 0 145.08 AL 1 133.93 AK 2 110.35 AZ Distribution Plots Distribution Plot sns.distplot(miaSerie): questa funzione, in pratica, se applicata ad una Series di Pandas produce automaticamente un istogramma. Occhio che il comando qui sotto e’ deprecato, e verra rimosso in futuro. Non e’ chiaro perche’, ma nelle note del “warning” di python indicano di usare una funzione con lo stesso nome: distplot ma che e’ “a figure-level function”, oppure: histplot Questa funzione in ogni modo fa un istogramma di una colonna (Series) di un dataframe di Pandas. Inoltre per default fa anche un kernel density estimation (KDE), possiamo spegnerlo con kde=False bins e’ il numero di bin dell’immagine, non la loro larghezza (ovviamente visto che ha una s…) sns.distplot(crash_df[&#39;not_distracted&#39;], kde=False, bins=15) C:\\ProgramData\\Anaconda3\\lib\\site-packages\\seaborn\\distributions.py:2551: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms). warnings.warn(msg, FutureWarning) &lt;AxesSubplot:xlabel=&#39;not_distracted&#39;&gt; Joint Plots La funzione: sns.jointplot costruisce uno scatterplot con “aggiunte”. viene fatto per paragonare 2 distribuzioni diverse (che saranno 2 colonne di un DataFrame). In pratica fa un scatter plot, e sopra e sotto mette anche gli istogrammi relativi alle colonne. inolte si puo’ aggiungere al volo una regressione lineare con il comando kind=&#39;reg&#39; nello scatterplot e i kernel sopra gli istogrammi. il comando kind definisce lo stile di visualizzazione. vanno passate delle x e delle y in forma di Series che costituiranno le coordinate dei punti dello scatterplot. Ovviamente il numero di oggetti delle x e delle y deve essere lo stesso, altrimenti per un punto ci sarebbe solo una coordinata ma non la seconda… sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df, kind =&#39;reg&#39; ); sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df ); # ho tolto la curva con il kernel estimation e la regressione Attenzione che il grafo nel video non ha solo le isoipse ma anche un sistema di colorazione che in qui sotto non appare! sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df, kind= &#39;kde&#39; ); sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data=crash_df, kind= &#39;hex&#39; ); KDE plot La funzione Kdeplot costruisce una sorta di interpolazione dei dati di una series. nota che nel grafico sotto non appare la legenda, mentre nel video c’e’ di default! sns.kdeplot(crash_df[&#39;alcohol&#39;]); Pair Plot Fa vedere la relazione tra tutte le coppi di colonne contenenti valori numerici dell’intero DataFrame. Esclude i valori categorici Occhio che e’ lento! Anche in questo caso il comando kind=... definisce come viene visualizzato lo scatterplot. Nell’esempio sotto solo le isoipse. sns.pairplot(crash_df, kind = &#39;kde&#39;); # nel video fa anche i colori e non solo le linee di livello Pairplot Hue hue assegna un colore diverso a tutti i valori della colonna indicata. Per esmepio in questo caso hue=’sex’, quindi i punti associati a Male e Female sono colorati in modo diverso. In pratica lui va a prendere i dati, li divide per sesso, poi li disegna automaticamente sullo stesso grafico ma con colori diversi! Nota: si puo’ usare anche con variabili categoriche, non solo le variabili numeriche (anzi penso che possa avere dei problemi se le variabili numeriche sono float…) tips_df = sns.load_dataset(&#39;tips&#39;) print(tips_df.head(3)) sns.pairplot(tips_df, hue=&#39;sex&#39;, palette=&#39;Blues&#39;); # occhio che qui c&#39;e&#39; il sesso del pagante non del ricevente... total_bill tip sex smoker day time size 0 16.99 1.01 Female No Sun Dinner 2 1 10.34 1.66 Male No Sun Dinner 3 2 21.01 3.50 Male No Sun Dinner 3 Rug plot Questo tipo di grafico fa vedere delle lineette per ogni punto. In pratica fa un unfolding di un istogramma. sns.rugplot(tips_df[&#39;tip&#39;]); Styling serve per modificare l’aspetto delle figure Problema, se cambio i parametri di figsize, mi restituisce un “Figure size 576x864 with 0 Axes”, e i valori contenuti sono coerenti coi parametri che ho dato… ma il grafico non viene modificato! Forse il problema e’ legato all’inline lanciato all’inizio mentre in un eventuale salvataggio a file otterrei dei risultati differenti? spine e’ il termine tecnico associato agli assi. Se per esempio non voglio che uno degli assi appaia nel grafico posso usare la funzione despine. Attenzione che va messo sotto il comando del disegno joinplot altrimenti non ha effetto! set_context modifica i parametri in modo che la dimensione dei font e del grafico siano proporzionati in base al contesto. Per esempio se faccio un poster ho bisogno di label grandi… set_style sono le combinazioni di colori dello sfondo #sns.set_style (&#39;white&#39;) sns.set_style (&#39;darkgrid&#39;) #sns.set_style (&#39;whitegrid&#39;) #sns.set_style (&#39;ticks&#39;) plt.figure(figsize=(8,5)) # non funge, devo capire perche&#39;! sns.set_context(&#39;paper&#39;, font_scale=1.5) #sns.set_context(&#39;talk&#39;, font_scale=1.5) # ingrandisce tutto #sns.set_context(&#39;poster&#39;, font_scale=1.5) sns.jointplot(x=&#39;speeding&#39;, y=&#39;alcohol&#39;, data= crash_df, kind=&#39;reg&#39;); sns.despine(left=True, right=False, top=True, bottom=False) # Occhio va messo SOTTO joinplot altrimenti non fa nulla &lt;Figure size 576x360 with 0 Axes&gt; Categorical Plotting Bar Plots barplot() di default fa vedere la mean La barra nera fa vedre la varianza devo passare cosa ci sia sulle x e sulle y (e il dataframe da cui sono prese) sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df); Possiamo usare funzioni diverse per stimare i valori categorici, per esempio tutti quelli in numpy, come la mediana, o la moda (non mi e’ riuscito)! Attento se fai 2 barplot, li sovrappone e non si capisce nulla Si possono usare delle funzioni custom fatte da noi, suppongo che di base si debba lavorare con un oggetto di tipo Series di Pandas #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.median); # mediana #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.std); # deviazione standard #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.var); # varianza sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=np.cov); # covarianza #from scipy.stats import mode # non sono riuscito a fargli usare la moda #sns.barplot(x=&#39;sex&#39;, y=&#39;total_bill&#39;, data=tips_df , estimator=mode); Count Plot countplot e’ come un barplot ma l’estimatore conta solo il numero di occorrenze, per questo non ha bisogno della y (e’ automaticamente il numero di occorrenze) sns.countplot(x=&#39;sex&#39;, data=tips_df) &lt;AxesSubplot:xlabel=&#39;sex&#39;, ylabel=&#39;count&#39;&gt; Box Plot boxplot() fa vedere il grafico a baffi con i quartili dei dati. la linea nera e’ la mean la scatola si estende di una deviazione standard (siamo sicuri? calcola la deviazione standard destra e sinistra? Di solito (wikipedia) la scatola indica il primo e il terzo quartile, devo controllare). I whiskers (baffi) si estendono fino ??? .In alcune rappresentazioni si estendono fino al massimo e al minimo I punti sono outliers (che non stanno nei baffi). Non e’ spiegato bene nella documentazione di Seaborn. Se usano la convenzione per gli outlier che uso io e’ Q3 + 3 IQ (dove l’interquartile e’ la differenza tra il terzo e il primo quartile IQ= Q3-Q1). sulle x vengono selezionati vari insiemi di dati sulle y viene fatto il grafico a baffi di quei particolari dati (vedi il grafico che e’ chiaro) L’estensione dei whisker non viene spiegata bene nelle note di Seaborn. sns.boxplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); plt.legend(loc=1); # la legenda in alto a sx e&#39; loc =0 Violin Plot Una combinazione di boxplot e kde plot, dove usa i kernel. Il nome e’ ovvio… sns.violinplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); # E&#39; inutile mettere tutto il violino per una sola categoria, mettiamo mezzo per una e mezzo per l&#39;altra: split sns.violinplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;,split=True); Strip plot stripplot() si usa quando una variabile e’ categorica: jitter non mi pare che faccia una grande differenza, dovrebbe sparpagliare meglio i punti hue funziona assegna dei colori diversi in base ad una variabile categorica dodge, separa fisicamente i punti con hue differente Prima non disegnava correttamente, perche’ dove avevo scritto fig, ax= plt.subplots(1,2, figsize=(15,5)) avrei invece dovuto scrivere ‘fig, axes=…’ ###### HO fatto qualche modifica rispetto al video, in modo da paragonare con e senza jitter ##### #plt.figure(figsize=(8,5)) fig, axes =plt.subplots(1,2 ,figsize=(15, 5) ) # grafici uno da parte all&#39;altro sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, ax=axes[0]); sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, ax=axes[1], jitter=True); #fig.show() # non serve in un jupyter notebook sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True); # jitter muove un po&#39; in giro i punti sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, hue=&#39;sex&#39;); Separo le hue, ma le lascio allo stesso giorno. Questo viene ottenuto tramite il comando dodge separa fisicamente i due gruppi di punti. sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, hue=&#39;sex&#39;, dodge=True); Swarm plot (lo sciame) violinplot() combina i plot precedenti. in pratica definisce la posizione dei punti come se fossero delle foglie, il primo al centro poi un a dx in alto , sx in alto.. Prima riguardiamo il violino (poi lo confrontiamo con lo swarmplot) sns.violinplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df); # poi vediamo lo sciame. sns.swarmplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df); # metto insieme il violino e lo sciame sns.violinplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df); sns.swarmplot(x=&#39;day&#39; , y=&#39;total_bill&#39;, data=tips_df, color=&#39;white&#39;); Palettes palette e’ un parametro una palette e’ un insieme di colori predefiniti. in cui definiamo anche una topologia tra colori: ovvero quale colore e’ vicino a quale colore. punto di partenza una palette standard Le palette si trovano qui: https://matplotlib.org/3.3.3/tutorials/colors/colormaps.html ) plt.figure(figsize=(8,5)) # funge! se non lo metto sotto diventa tutto piu&#39; piccolo sns.set_style(&#39;dark&#39;) sns.set_context(&#39;talk&#39;) sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); cambio palette plt.figure(figsize=(8,5)) sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;, palette=&#39;PuBu&#39;); # PuBu=palette trovata su matplotlib Legend qualche comando per muovere la legenda. In teoria: loc = 0 sceglie lui la posizione ottimale upper right=1 upper left =2 lower left =3 lower right =4 Cerca Matplotib legends e ci sono tutte le opzioni https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.legend.html #plt.figure(figsize=(8,5)) # funge! se non lo metto sotto diventa tutto piu&#39; piccolo plt.figure(figsize=(8,7)) # funge! se non lo metto sotto diventa tutto piu&#39; piccolo sns.set_style(&#39;dark&#39;) sns.set_context(&#39;talk&#39;) sns.stripplot(x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, hue=&#39;sex&#39;); #plt.legend(loc=0) # best = sceglie lui la posizione #plt.legend(loc=1) # in alto a dx #plt.legend(loc=2) # in alto a sx #plt.legend(loc=3) # in basso a sx plt.legend(loc=4) # in basso a dx &lt;matplotlib.legend.Legend at 0x12265a93550&gt; Matrix Plot In questo caso vogliamo visualizzare una matrice, ovvero un oggetto con righe e colonne. In ogni ingresso della matrice avro’ dei valori e voglio visualizzarli. Heatmaps heatmap() qui sotto prendiamo il crash_df e cerchiamo di costruire delle heatmaps argomenti utili: cmap = ‘Blues’ e’ la colormap annot =True scrivi anche il valore della colorazione nella casella (altrimenti fa solo il colore) crash_df.head(3); # riguardiamo questo df Qui sotto uso un metodo (di Pandas?) per cui dato un dataframe con valori numerici e categorici calcola la correlazione tra ogni coppia di colonne numeriche crash_mx = crash_df.corr() crash_mx.head(3) total speeding alcohol not_distracted no_previous ins_premium ins_losses total 1.000000 0.611548 0.852613 0.827560 0.956179 -0.199702 -0.036011 speeding 0.611548 1.000000 0.669719 0.588010 0.571976 -0.077675 -0.065928 alcohol 0.852613 0.669719 1.000000 0.732816 0.783520 -0.170612 -0.112547 plt.figure(figsize=(8,6)) sns.set_context(&#39;paper&#39;, font_scale=1.4) #sns.heatmap(crash_mx, annot=True, cmap=&#39;Blues&#39;) # fa vedere anche i numeri nelle caselle colorate sns.heatmap(crash_mx, annot=False, cmap=&#39;magma&#39;) # fa vedere SOLO i colori &lt;AxesSubplot:&gt; Pivot Table questo e’ un altro modo per costruire una matrice. NEll’esempio sotto quello che fa e’: indico l’index ovvero l’attributo che viene usato per l’indice di riga indico le columns, ovvero l’attributo che viene usato per l’indice di colonna A questo punto lui va. Controlla tutti gli i valori dell’attributo per l’index. Li usa per costruire una tabelle di cui sono tutte le righe. Poi va e controlla i valori dell’attributo per le columns e costruisce le colonne. Poi va e pesca per ognuno degli attributi dell’index e delle columns i valori dati come values e li mette nelle caselle. flights = sns.load_dataset(&#39;flights&#39;) flights.head(3) year month passengers 0 1949 Jan 112 1 1949 Feb 118 2 1949 Mar 132 flights.pivot_table(index=&#39;month&#39;, columns=&#39;year&#39;, values=&#39;passengers&#39;) # NON lavora INPLACE (invece nel video si&#39;) flights_pt = flights.pivot_table(index=&#39;month&#39;, columns=&#39;year&#39;, values=&#39;passengers&#39;) #sns.heatmap(flights.pivot_table(index=&#39;month&#39;, columns=&#39;year&#39;, values=&#39;passengers&#39;), annot=False, cmap=&#39;Blues&#39;) # IDENTICO fig, axes = plt.subplots(1, 2, figsize=(12, 5), sharey=True) sns.heatmap (flights_pt, ax=axes[0],annot=False, cmap=&#39;Blues&#39;) sns.heatmap (flights_pt, ax=axes[1],annot=False, cmap=&#39;Blues&#39;, linecolor=&#39;white&#39;, linewidth=1) ; #larghezza linea default 0? Cluster Map clustermap() hierarchically clusterd heatmap = heatmap ottenuta cone una clusterizzazione gerarchica la distanza tra tutti i punti e’ calcolata i piu’ vicini sono uniti il lavoro continua con il prossimo vicino quindi paragona le colonne e le righe A differenza della heatmap, dove l’ordine degli attributi e’ mantenuto costante, in questo caso viene riordinato seguendo il clustering. iris = sns.load_dataset(&#39;iris&#39;) # e&#39; un pandas dataframe di default iris.head(3) #sns.clustermap(iris) sepal_length sepal_width petal_length petal_width species 0 5.1 3.5 1.4 0.2 setosa 1 4.9 3.0 1.4 0.2 setosa 2 4.7 3.2 1.3 0.2 setosa species = iris.pop(&#39;species&#39;) # pop spara fuori una colonna e la trasforma in una Series Heatmap ottenuta con una clusterizzazione gerarchica sns.clustermap(iris); # heatmap ottenuta con una clusterizzazione gerarchica Ricorda che la pivot table ho dovuto rinominarla, per lui fights e’ la pivot table, per me e’ flights_pt #sns.clustermap(flights , cmap =&#39;Blues&#39;, standard_scale =1) # NON FUNGE normalizza i dati per focalizzarci sul clustering sns.clustermap(flights_pt , cmap =&#39;Blues&#39;, standard_scale =1); # normalizza i dati per focalizzarci sul clustering un commento a quanto qui sopra. Pensale in termine di sequenze numeriche, in cui il colore e’ un numero. Puoi avere sequenze verticali e orizzontali. Prendiamo ora le sequenze orizzontali. Le due piu’ in alto sono molto chiare, ma non sono le piu’ vicine, infatti Nov e Jan sono connesse. Poi si connette Feb. Non mi e’ chiaro il dendrogramma come venga poi costruito. Mi pare di capire che alla fine ci possano essere solo delle coppie. Se il primo vicino di una sequenza e’ gia’ in una coppia, questa rimane isolata e va attaccata alla coppia oppure… devo pensare all’algoritmo. Nota che a causa del clustering mi aspetto di vedere striscie. Questo perche’ sequenze simili vanno messe vicine tra loro. Potrebbero mettere un puntino al centro di ogni cella. Questo punto si puo’ muovere sull’asse delle z o delle y .Il modvimento e’ lo stesso sui due assi e in questo modo si vedono le sequenze sia guardando le righe che le colonne! Pair Grids PairGrid() Prima abbiamo visto i pairplots, dove si facevano degli scatter plot tra tutte le coppie di colonne del DataFrame. Per prima cosa creiamo una grid vuota. iris = sns.load_dataset(&#39;iris&#39;) iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie iris_g.map(plt.scatter); # questo mi pare un comando di matplotlib o PANDAS Ora vogliamo mettere un istogramma lungo la diagonale (della griglia di grafici). iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie #iris_g.map(plt.scatter); # questo mi pare un comando di matplotlib o PANDAS iris_g.map_diag(plt.hist); # nei grafi diagonali inserisce un istogramma iris_g.map_offdiag(plt.scatter); # non mette gli scatterplot diagonali! (occhio che devi commentare l&#39;altro!) Ora vogliamo mettere delle altre cose nella: parte superiore (della matrice di grafici) parte inferiore (della matrice di grafici) quindi diamo un comando chen indica cosa mettere sulla diagonale e poi uno per la triangolare superiore e uno per la triangoplar e superiore. Occhio che si deve passare come argomento di map_diag (oppure map_lower o map_upper) il nome della funzione che si userebbe per diegnare un singolo plot di questo tipo. iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie iris_g.map_diag(plt.hist); # nei grafi diagonali inserisce un istogramma iris_g.map_upper(plt.scatter); # sopre metti gli scatter plot iris_g.map_lower(sns.kdeplot); # sotto metti KDE quindi devi usare la funzione di SEABORN Variabili per la nostra custom grid #iris_g = sns.PairGrid(iris, hue=&#39;species&#39;) # assegna un colore diverso alle varie specie iris_g = sns.PairGrid(iris, hue=&#39;species&#39;, x_vars=[&quot;sepal_length&quot;, &quot;sepal_width&quot;], y_vars= [&quot;petal_length&quot;, &quot;petal_width&quot;] ) iris_g.map(plt.scatter); # map e&#39; usata in modo molto potente iris_g.add_legend(); Facet Grid FacetGrid() E’ una specie di subplots di matplotlib ma con delle cose predefinite. posso disegnare plot multipli in una griglia (grid) posso definire le colonne e righe Si crea un sistema a forma di griglia (in cui pero’ non abbiamo ancora messo nulla). Al primo passo indico le colonne e le righe, per esempio: nelle colonne metto il tempo (time). Che puo’ assumere 2 valori: Dinner e Lunch nelle righe metto ‘smoker’. Che puo’ assumere 2 valori: yes e no Quindi la griglia che ho creato e’ 2x2. In ogni ingresso della griglia devo mettere un grafico. Cosa metto? Map Il metodo map() di python e’ utilissimo perche’ posso passare anche delle funzioni! Mappo ogni grafo con il metodo map() e faccio un istogramma della quantita’ ‘total_bill’. Queste quantita’ saranno limitata al valore di ‘time’ e ‘smoker’ corrispondente alla griglia! Quindi per esempio in alto a sx: smoker = yes time = lunch Faccio l’istogramma di tutti i ‘total_bill’ che si riferiscono a smoker e lunch. Ricapitolando con FacetGrid definisco una griglia associata a due colonne, che formeranno le righe e le colonne della griglia. Per ogni valore di ciascuna delle due colonne faccio un grafico riferito, ad una terza colonna tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) # qui resta vuota. sns.set_context(&#39;paper&#39;, font_scale=1.5) tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) tips_fg.map(plt.hist, &#39;total_bill&#39;, bins=8 ); # mappa la funzione plt.hist, sulla quantita &#39;total_bill&#39; tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) tips_fg.map(plt.hist, &#39;day&#39; ) &lt;seaborn.axisgrid.FacetGrid at 0x122685a3ac0&gt; tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, row=&#39;smoker&#39;) tips_fg.map(plt.scatter, &#39;total_bill&#39;, &#39;tip&#39;); Nel caso sotto invece, facciamo una griglia che contiene solo colonne. Non ci sono righe, pero’ adesso usiamo il comando hue che ci permette di usare un colore diverso in base all’argomento usato. In questo caso uso come hue=’smoker’ Aggiungo un prametro, col_order che mi consente di ordinare le colonne. Basta mettere una lista contenente il nome delle colonne volute e l’ordine di quella lista sara’ seguito dal plot. tips_fg= sns.FacetGrid(tips_df, col=&#39;time&#39;, hue=&#39;smoker&#39;, height=4, aspect=1.3, col_order=[&#39;Dinner&#39;,&#39;Lunch&#39;] , palette=&#39;Set1&#39;) tips_fg.map(plt.scatter, &#39;total_bill&#39;, &#39;tip&#39;, edgecolor =&#39;w&#39;); Gli stili, le linee etc creo quindi un dizionario, in cui ci sono i parametri, lo chiamo kws costruisco una Griglia faccettata (FacedGrid), in cui: le colonne sono i valori di ‘sex’ punti che corrispondono a fumatori e non fumatori sono in colori diversi hue=’smoker’ altezza = 4 height=4 aspect = 1.3 (non ricordo cosa faccia) a questo punto mappo la funzione plt.scatter sulla griglia faccettata, tramite map. Alla funzione map passo 3 parametri: le x che sono ‘total_bill’ le y che e’ ‘tip’ kws sintassi strana devo mettere due asterischi *, davanti al dizionario quando lo passo! Ho trovato che non gli piace il fatto che definisca le colonne della FacetGrid tramite la variabile ‘sex’, forse perche’ e’ categorica? se metto time funge. Ho trovato l’errore. Io non penso in modo “case sensitive”, nell’esempio si mette hue_order=[&#39;yes&#39;, &#39;No&#39;], io invece avevo preso tutto in minuscolo. Per questo non scriveva nulla: non c’era corrispondenza tra: i valori dello hue: Yes,No i valori dello hue_order: yes, no Attento devi controllare che negli argomenti ci sia perfetta corrispondenza tra i nomi! Domanda cosa fanno i doppi asterischi davanti al dizinoario? Risposta fa un-packing dell’oggetto. kws = dict(s=50, linewidth=0.5, edgecolor =&#39;w&#39;) # ho creato un dizionario con 3 ingressi tips_fg = sns.FacetGrid(tips_df, col =&#39;sex&#39;, hue=&#39;smoker&#39;, height=4, aspect=1.3, hue_order=[&#39;Yes&#39;, &#39;No&#39;], hue_kws=dict(marker=[&#39;^&#39;,&#39;v&#39;])) # triangolini in su e triangolini in giu&#39; tips_fg.map(plt.scatter, &#39;total_bill&#39;, &#39;tip&#39;, **kws); # nota sintattica, qui gli passo ** Altro dataset: attention Ho degli studenti, ne voglio mettere 5 per linea. Per fare questo indico solo quale sia la variabile che uso per le colonne Poi tramite col_warps=5 indico che devono esserci solo 5 colonne al max, poi va a capo lui automaticamente numero di colonne per linea col_wrap=5 se non uso col_wrap=5 lui mette ogni valore di subject in una colonna diversa, ce ne sono 20… att_df = sns.load_dataset(&#39;attention&#39;) att_fg = sns.FacetGrid(att_df, col=&#39;subject&#39;) att_fg.map(plt.plot, &#39;solutions&#39;, &#39;score&#39;, marker=&#39;.&#39;) &lt;seaborn.axisgrid.FacetGrid at 0x122692041f0&gt; att_fg = sns.FacetGrid(att_df, col=&#39;subject&#39;, col_wrap=5, height=1.5) att_fg.map(plt.plot, &#39;solutions&#39;, &#39;score&#39;, marker=&#39;.&#39;) &lt;seaborn.axisgrid.FacetGrid at 0x1226863a4f0&gt; att_df.head(3) Unnamed: 0 subject attention solutions score 0 0 1 divided 1 2.0 1 1 2 divided 1 3.0 2 2 3 divided 1 3.0 Regression Plots Uso tip data, faccio uno scatter plot con interpolazione. lmplot() (linear regression?) Faccio due interpolazioni diverse per ognuno delle differenti hue plt.figure(figsize= (8,6)) sns.set_context(&#39;paper&#39;, font_scale=1.4) sns.lmplot(x=&#39;total_bill&#39;, y=&#39;tip&#39;, hue=&#39;sex&#39;, data = tips_df, markers=[&#39;o&#39;, &#39;^&#39;], scatter_kws={&#39;s&#39;:100, &#39;linewidth&#39;:0.5, &#39;edgecolor&#39;:&#39;w&#39;}); # regression plot &lt;Figure size 576x432 with 0 Axes&gt; Qui sotto usa i comandi col e row per costruire una sorta di FacetGrid automatica, tramite la funzione lmlpot (che fa la regressione). Anche in questo caso viene costruita una griglia. Questa griglia seleziona i punti e poi per i punti che hanno le caratteristiche che combaciano con quelle della griglia si fa il regression plot sns.lmplot(x=&#39;total_bill&#39;, y=&#39;tip&#39;, col=&#39;sex&#39;, row=&#39;time&#39;, data=tips_df); Salvare le figure Per salvare i file si usano semplicemente le funzioni di Matplotlib. In praticolare si deve: chiamare una funzione che faccia un’immagine subito dopo chiamare plt.savefig(&#39;nomeImmagine.eps&#39;) cambiando l’estensione si ottengono file diversi, per esempio png, pdf,... sns.lmplot(x=&#39;total_bill&#39;, y=&#39;tip&#39;, col=&#39;sex&#39;, row=&#39;time&#39;, data=tips_df); plt.savefig(&#39;prova.pdf&#39;) Subplots (Matplotlib) questo e’ piu’ correlato con matplotlib, comunque e’ utile anche in questo notebook. #import pandas as pd #import seaborn as sns #from matplotlib import pyplot as plt pokemon = pd.read_csv(&#39;pokemon.csv&#39;) #p_df.head() # bulbasaur = pokemon[[&#39;Name&#39;, &#39;HP&#39;, &#39;Attack&#39;, &#39;Defense&#39;, &#39;Sp. Atk&#39;, &#39;Sp. Def&#39;, &#39;Speed&#39;]][pokemon.loc[:, &#39;Name&#39;] == &#39;Bulbasaur&#39;] poke_num = pokemon[[&#39;Name&#39;, &#39;HP&#39;, &#39;Attack&#39;, &#39;Defense&#39;, &#39;Sp. Atk&#39;, &#39;Sp. Def&#39;, &#39;Speed&#39;]].set_index(&#39;Name&#39;) bulbasaur = poke_num.loc[&#39;Bulbasaur&#39;] charmander = poke_num.loc[&#39;Charmander&#39;] squirtle = poke_num.loc[&#39;Squirtle&#39;] fig, axes = plt.subplots(1, 3, figsize=(15, 5), sharey=True) fig.suptitle(&#39;Initial Pokemon - 1st Generation&#39;) # Bulbasaur sns.barplot(ax=axes[0], x=bulbasaur.index, y=bulbasaur.values) axes[0].set_title(bulbasaur.name) # Charmander sns.barplot(ax=axes[1], x=charmander.index, y=charmander.values) axes[1].set_title(charmander.name) # Squirtle sns.barplot(ax=axes[2], x=squirtle.index, y=squirtle.values) axes[2].set_title(squirtle.name) Text(0.5, 1.0, &#39;Squirtle&#39;) tips_df = sns.load_dataset(&#39;tips&#39;) #fig, axes =plt.subplots(1,3, figsize=(15,5), sharey=True) fig, axes =plt.subplots(1,3, figsize=(15,5)) sns.stripplot( ax=axes[0] ,x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, palette=&#39;magma&#39;) # FUNGE sns.stripplot( ax=axes[1], x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, palette=&#39;PuOr&#39;) # FUNGE sns.stripplot( ax=axes[2], x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True, palette=&#39;winter&#39;) # FUNGE #sns.stripplot( x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df) # NON FUNGE #sns.stripplot( x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True) # NON FUNGE #sns.stripplot( x=&#39;day&#39;, y=&#39;total_bill&#39;, data=tips_df, jitter=True) # NON FUNGE &lt;AxesSubplot:xlabel=&#39;day&#39;, ylabel=&#39;total_bill&#39;&gt;","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/Seaborn"},"@type":"BlogPosting","url":"http://localhost:4000/Seaborn","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
	<header>
  
    <nav class="top-nav light-blue darken-4">
  <div class="nav-wrapper">
    <div class="container">
      <a class="page-title font-title" href="/">4Phycs</a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li><a href="/tags">Tags</a></li>
        <li><a href="/categories">Ita-Eng</a></li>
        <li><a href="/me">Me</a></li>
        <li><a href="/about">About</a></li>
        <li><a href="/contact">Contact</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="container">
  <a href="#" data-activates="slide-out" class="button-collapse top-nav full hide-on-large-only">
    <i class="material-icons">menu</i>
  </a>
</div>
<div id="slide-out" class="side-nav fixed">
  <div>
    <div class="userView thi-userView">
      <div class="background"></div>
        <a href="/">
          <img style="display:inherit;" class="circle z-depth-2" src="/assets/res/user.png">
        </a>
      <span style="font-size: larger;" class="white-text name">Paolo Avogadro</span>
      <span class="white-text email"><a style="color: #bdbdbd;" href="http://"></a></span>
    </div>
  </div>
  <div style="padding: 10px;">
    <form action="/search" method="get">
      <input class="search-sidebar" type="search" name="q"  placeholder="search something?" autofocus>
      <input type="submit" value="Search" style="display: none;">
    </form>
  </div>
  <div id="toc-bar">
    <div class="toc-bar-title">
      In this post
    </div>
    <ol id="toc-sidebar">
  <li><a href="#seaborn">Seaborn:</a>
    <ol>
      <li><a href="#dataset-di-seaborn">Dataset di Seaborn</a></li>
    </ol>
  </li>
  <li><a href="#distribution-plots">Distribution Plots</a>
    <ol>
      <li><a href="#distribution-plot">Distribution Plot</a></li>
      <li><a href="#joint-plots">Joint Plots</a></li>
      <li><a href="#kde-plot">KDE plot</a></li>
      <li><a href="#pair-plot">Pair Plot</a></li>
      <li><a href="#pairplot">Pairplot</a></li>
      <li><a href="#rug-plot">Rug plot</a></li>
    </ol>
  </li>
  <li><a href="#styling">Styling</a></li>
  <li><a href="#categorical-plotting">Categorical Plotting</a>
    <ol>
      <li><a href="#bar-plots">Bar Plots</a></li>
      <li><a href="#count-plot">Count Plot</a></li>
      <li><a href="#box-plot">Box Plot</a></li>
      <li><a href="#violin-plot">Violin Plot</a></li>
      <li><a href="#strip-plot">Strip plot</a></li>
      <li><a href="#swarm-plot-lo-sciame">Swarm plot (lo sciame)</a></li>
    </ol>
  </li>
  <li><a href="#palettes">Palettes</a></li>
  <li><a href="#legend">Legend</a></li>
  <li><a href="#matrix-plot">Matrix Plot</a>
    <ol>
      <li><a href="#heatmaps">Heatmaps</a></li>
      <li><a href="#pivot-table">Pivot Table</a></li>
      <li><a href="#cluster-map">Cluster Map</a></li>
      <li><a href="#heatmap-ottenuta-con-una-clusterizzazione-gerarchica">Heatmap ottenuta con una clusterizzazione gerarchica</a></li>
      <li><a href="#pair-grids">Pair Grids</a></li>
      <li><a href="#facet-grid">Facet Grid</a></li>
      <li><a href="#map">Map</a></li>
      <li><a href="#gli-stili-le-linee-etc">Gli stili, le linee etc</a></li>
      <li><a href="#altro-dataset-attention">Altro dataset: attention</a></li>
    </ol>
  </li>
  <li><a href="#regression-plots">Regression Plots</a></li>
  <li><a href="#salvare-le-figure">Salvare le figure</a></li>
  <li><a href="#subplots-matplotlib">Subplots (Matplotlib)</a></li>
</ol>

  </div>
</div>
  
</header>
<main>
  <div class="container">
    <div id="post-info">
      <h3>Seaborn - appunti</h3>
      <span>
        Posted on
        <span style="display: initial;" class="cat-class">08/11/2021</span>,
        in
        
          
          
            <a class="cat-class cat-commas" href="/categories#italiano">Italiano</a>.
          
        
        <span class="reading-time" title="Estimated read time">
  
  
  <font size="2"> Reading time: 39 mins </font>
  
</span>

      </span>
    </div>

    <div class="divider"></div>
    <div class="row thi-post">
      <div class="col s12">
        <h1 id="seaborn">Seaborn:</h1>
<p>Questi appunti contengono esempi, commenti e grafici basati sul bel <strong><a href="https://www.youtube.com/watch?v=6GUZXDef2U0&amp;ab_channel=DerekBanas">video</a></strong> di Derek Banas di
 <a href="https://www.simplilearn.com/">Simplilearn</a>.</p>

<p>Qualunque errore e’ dovuto a me e non da imputare a Derek Banas.
Ho aggiunto anche pensieri e esempi che mi servivano.</p>

<p>In alcuni casi i comandi indicati da Banas mi davano problemi, 
probabilmente per le versioni di Python/Matplotlib/Seaborn. 
Ho cercato di farli girare con dei piccoli cambiamenti. La mia versione e’ basata su una Anaconda aggiornata 
al Novembre 2020, all’interno di un Jupyter notebook.</p>

<p>Alle volte faccio dei paragoni con Gnuplot, dato che e’ il mio sistema di visualizzazione di base…</p>

<p>E’ capitato che facessi degli errori banali, ho lasciato le note sulle soluzioni perche’ possono essere utili.</p>

<p><code class="language-plaintext highlighter-rouge">Introduzione</code>:</p>

<p>Seaborn e’ una libreria che lavora su Matplotlib e Pandas.
Visto che un DataFrame di Pandas ha molte colonne, spesso sara’ necessario fare dei grafici
multipli che contengano informazioni di tutte le coppie di colonne. In questo senso 
si puo’ vedere <code class="language-plaintext highlighter-rouge">Seaborn</code> come una serie di script che forniscono delle combinazioni
di comandi che rendono veloce e semplice le visualizzazioni multiple (per progetti di data science).</p>

<p>Alternativamente a Matplotlib esiste un’altra libreria chiamata <strong>bokeh</strong> (che esplorero’ in seguito)</p>

<p><strong>Trucco utilissimo</strong> (che non conoscevo/ricordavo) di Jupyter notebook</p>
<ul>
  <li>cliccki su una cella</li>
  <li>clicchi su una funzione</li>
  <li>premi shift-tab: ti fa vedere tutti gli argomenti che possono essere passati a quella funzione</li>
</ul>

<p>Quando mi riferisco alle <strong>funzioni</strong> di Seaborn, non parlo di metodi associati ai DataFrame. La sola differenza e’ che non si applicano tramite la dot “notation” dei metodi. Il DataFrame (o sue parti) e’ passato come argomenti delle funzioni stesse. Inoltre ci possono essere altri <code class="language-plaintext highlighter-rouge">argomenti</code> utili, come per esempio:</p>
<ul>
  <li><strong>hue</strong>       (assegna colori diversi a valori diversi, p.es. maschi e femmine)</li>
  <li><strong>palette</strong>   (sono combinazioni di colori, in cui viene definita una topologia di colori, per esemppio il successivo a questo rosso e’ quest’altro rosso…)</li>
  <li><strong>styling</strong>   (per cambiare la dimensione delle label..)</li>
  <li><strong>set_style</strong> (cambia lo sfondo)    <strong>non funge</strong> (forse perche’ faccio girare la cella dopo averne fatta girare un’altra che ha lasciato qualcosa in memoria)</li>
  <li><strong>font_scale</strong> (grandezza delle label)</li>
  <li><strong>spine</strong>     (gli assi, laterali e verticali) ATTENTO: va messo <strong>sotto</strong> il comando sns.joinplot</li>
  <li><strong>figsize</strong>   (indica l’aspect ratio del rettangolo, base e poi altezza). ATTENTO, in jupyter puoi chiedere che matplotlib sia inline, questo fa si’ che le figure siano dei png sul notebook, e si puo’ definire un dpi. Questo ultimo comando “fissa” la dimensione visibile della figura!</li>
  <li><strong>spine</strong> sono gli assi!</li>
  <li><strong>legend</strong>   (la legenda)</li>
  <li><strong>jitter</strong>   (per fare uno spredout dei punti in alcuni tipi di plot)</li>
  <li><strong>side by side</strong> ( per mettere 2 figure di seaborn una da parte all’altra cerca: <strong>subplots</strong>)</li>
  <li><strong>palettes</strong>  (cerca la lista: maplotlib colormaps https://matplotlib.org/3.3.3/tutorials/colors/colormaps.html )</li>
  <li><strong>pivot tables</strong> (per fare le matrici, definisci le righe e le colonne. Questo seleziona dei valori. Tipicamente per questi valori esistono varie righe del DataFrame, da cui posso estrarre un grafico per ognuna delle righe e colonne della pivot table.) In prarica una pivot table fa un <strong>prodotto cartesiano</strong> tra tutti gli elementi delle righe e delle colonne.</li>
  <li><strong>Subplot</strong> figure una di lato all’altra,o meglio all’interno di una “griglia” dove ci possono essere tanti grafici.</li>
</ul>

<p>Attento devi mettere il seguente con seaborn, che non c’e’ nel video di Banas:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ax=axes[0]</code> # per il primo</li>
  <li><code class="language-plaintext highlighter-rouge">ax=axes[1]</code> # per il secondo oggetto.</li>
</ul>

<p>Se non li metti il sistema non fa vedere la prima figura ma disegna un plot vuoto e fa vedere da parte l’ultimo plot
disegnato. Ho trovato l’esempio con i pokemon (sebbene la pagina sia poco leggibile): https://dev.to/thalesbruno/subplotting-with-matplotlib-and-seaborn-5ei8</p>

<p><strong>TRUCCO</strong>
ci sono vari magic command di Matplotlib oltre al solito <code class="language-plaintext highlighter-rouge">inline</code>:</p>

<p><code class="language-plaintext highlighter-rouge">%matplotlib inline</code> - Figures are shown as static png images (optionally svg if configured)</p>

<p><code class="language-plaintext highlighter-rouge">%matplotlib notebook</code> or %matplotlib nbagg - Interactive Figures inside the notebook</p>

<p><code class="language-plaintext highlighter-rouge">%matplotlib widgets</code> - - Interactive Figures inside the notebook (requires jupyter-matplotlib to be installed)</p>

<p><code class="language-plaintext highlighter-rouge">%matplotlib tk</code> or</p>

<p><code class="language-plaintext highlighter-rouge">Nota tecnica</code>:</p>

<p>Ho notato che una TOC poteva risultare utile, per questo ho installato <code class="language-plaintext highlighter-rouge">jupyter-navbar</code>.
Ho semplicemente scaricato lo zip da https://github.com/shoval/jupyter-navbar
e (dopo avere decompresso) ho fatto girare da Babun con python2.7 il file setup.py
(questo perche’ lo sto facendo girare in Windows 10).
In questo modo appare la barra con l’indice.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="c1">#sns.set()
</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="c1">#%matplotlib notebook
#%matplotlib tk
#%matplotlib widgets
</span>
<span class="c1"># questi sotto non so ancora cosa facciano
</span><span class="o">%</span><span class="n">reload_ext</span> <span class="n">autoreload</span> 
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#cs_df = pd.read_csv('ComputerSales.csv')  # dovrei trovarlo
</span></code></pre></div></div>

<h2 id="dataset-di-seaborn">Dataset di Seaborn</h2>
<p>posso sapere la lista di questi dataset e anche caricarli velocemente con il metodo <code class="language-plaintext highlighter-rouge">load_dataset</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span> <span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">get_dataset_names</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['anagrams', 'anscombe', 'attention', 'brain_networks', 'car_crashes', 'diamonds', 'dots', 'exercise', 'flights', 'fmri', 'gammas', 'geyser', 'iris', 'mpg', 'penguins', 'planets', 'tips', 'titanic']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">crash_df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s">'car_crashes'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">crash_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">crash_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(51, 8)
   total  speeding  alcohol  not_distracted  no_previous  ins_premium  \
0   18.8     7.332    5.640          18.048       15.040       784.55   
1   18.1     7.421    4.525          16.290       17.014      1053.48   
2   18.6     6.510    5.208          15.624       17.856       899.47   

   ins_losses abbrev  
0      145.08     AL  
1      133.93     AK  
2      110.35     AZ  
</code></pre></div></div>

<h1 id="distribution-plots">Distribution Plots</h1>

<h2 id="distribution-plot">Distribution Plot</h2>

<p><code class="language-plaintext highlighter-rouge">sns.distplot(miaSerie)</code>: questa funzione, in pratica, se applicata ad una <code class="language-plaintext highlighter-rouge">Series</code> di Pandas produce automaticamente un istogramma.</p>

<p>Occhio che il comando qui sotto e’ deprecato, e verra rimosso in futuro.
Non e’ chiaro perche’, ma nelle note del “warning” di python indicano di usare una funzione con lo stesso nome:</p>

<p><strong>distplot</strong> ma che e’ “a figure-level function”,</p>

<p>oppure:</p>

<p><strong>histplot</strong></p>

<p>Questa funzione in ogni modo fa un <strong>istogramma</strong> di una colonna (Series) di un dataframe di Pandas.</p>

<p>Inoltre per default fa anche un <strong>kernel density estimation</strong> (KDE), possiamo spegnerlo con kde=False</p>

<p><strong>bins</strong> e’ il numero di bin dell’immagine, non la loro larghezza (ovviamente visto che ha una s…)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">crash_df</span><span class="p">[</span><span class="s">'not_distracted'</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\ProgramData\Anaconda3\lib\site-packages\seaborn\distributions.py:2551: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
  warnings.warn(msg, FutureWarning)





&lt;AxesSubplot:xlabel='not_distracted'&gt;
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_8_2.png" alt="png" /></p>

<h2 id="joint-plots">Joint Plots</h2>
<p>La funzione: <code class="language-plaintext highlighter-rouge">sns.jointplot</code> costruisce uno scatterplot con “aggiunte”.</p>

<ul>
  <li>
    <p>viene fatto per paragonare 2 distribuzioni diverse (che saranno 2 colonne di un DataFrame).</p>
  </li>
  <li>
    <p>In pratica fa un scatter plot, e sopra e sotto mette anche gli istogrammi relativi alle colonne.</p>
  </li>
  <li>
    <p>inolte si puo’ aggiungere al volo una <em>regressione lineare</em> con il comando <code class="language-plaintext highlighter-rouge">kind='reg'</code> nello scatterplot e i kernel sopra gli istogrammi.</p>
  </li>
  <li>
    <p>il comando kind definisce lo stile di visualizzazione.</p>
  </li>
  <li>
    <p>vanno passate delle x e delle y in forma di Series che costituiranno le coordinate dei punti dello scatterplot. Ovviamente il numero di oggetti delle x e delle y deve essere lo stesso, altrimenti per un punto ci sarebbe solo una coordinata ma non la seconda…</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'speeding'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'alcohol'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">crash_df</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span><span class="s">'reg'</span> <span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_10_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'speeding'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'alcohol'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">crash_df</span> <span class="p">);</span>  <span class="c1"># ho tolto la curva con il kernel  estimation e la regressione
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_11_0.png" alt="png" /></p>

<p><strong>Attenzione</strong> che il grafo nel video non ha solo le isoipse ma anche un sistema di colorazione 
 che in qui sotto non appare!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'speeding'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'alcohol'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">crash_df</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span> <span class="s">'kde'</span> <span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_13_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'speeding'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'alcohol'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">crash_df</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span> <span class="s">'hex'</span> <span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_14_0.png" alt="png" /></p>

<h2 id="kde-plot">KDE plot</h2>

<p>La funzione Kdeplot costruisce una sorta di interpolazione dei dati di una series.</p>

<p>nota che nel grafico <strong>sotto</strong> non appare la <code class="language-plaintext highlighter-rouge">legenda</code>, mentre nel video c’e’ di default!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">crash_df</span><span class="p">[</span><span class="s">'alcohol'</span><span class="p">]);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_16_0.png" alt="png" /></p>

<h2 id="pair-plot">Pair Plot</h2>
<p>Fa vedere la relazione tra tutte le coppi di colonne contenenti <strong>valori numerici</strong> dell’intero DataFrame.</p>

<ul>
  <li>
    <p>Esclude i <strong>valori categorici</strong></p>
  </li>
  <li>
    <p>Occhio che e’ lento!</p>
  </li>
  <li>
    <p>Anche in questo caso il comando <code class="language-plaintext highlighter-rouge">kind=...</code> definisce come viene visualizzato lo scatterplot. Nell’esempio sotto solo le isoipse.</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">crash_df</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s">'kde'</span><span class="p">);</span>  <span class="c1"># nel video fa anche i colori e non solo le linee di livello
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_18_0.png" alt="png" /></p>

<h2 id="pairplot">Pairplot</h2>
<h3 id="hue">Hue</h3>
<p><strong>hue</strong> assegna un colore diverso a tutti i valori della colonna indicata. Per esmepio in questo caso <strong>hue=’sex’</strong>,
quindi i punti associati a Male e Female sono colorati in modo diverso.</p>

<p>In pratica lui va a prendere i dati, li divide per sesso, poi li disegna automaticamente sullo stesso grafico ma con colori diversi!</p>

<p>Nota: si puo’ usare anche con variabili categoriche, non solo le variabili numeriche (anzi penso
che possa avere dei problemi se le variabili numeriche sono float…)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tips_df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s">'tips'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tips_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'sex'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'Blues'</span><span class="p">);</span>            <span class="c1"># occhio che qui c'e' il sesso del pagante non del ricevente...
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   total_bill   tip     sex smoker  day    time  size
0       16.99  1.01  Female     No  Sun  Dinner     2
1       10.34  1.66    Male     No  Sun  Dinner     3
2       21.01  3.50    Male     No  Sun  Dinner     3
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_20_1.png" alt="png" /></p>

<h2 id="rug-plot">Rug plot</h2>
<p>Questo tipo di grafico fa vedere delle lineette per ogni punto. 
In pratica fa un unfolding di un istogramma.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">tips_df</span><span class="p">[</span><span class="s">'tip'</span><span class="p">]);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_22_0.png" alt="png" /></p>

<h1 id="styling">Styling</h1>
<p>serve per modificare l’aspetto delle figure</p>

<p>Problema, se cambio i parametri di figsize, mi restituisce un “Figure size 576x864 with 0 Axes”, e i valori contenuti sono coerenti coi parametri che ho dato… ma il grafico non viene modificato! Forse il problema e’ legato all’<code class="language-plaintext highlighter-rouge">inline</code> lanciato all’inizio mentre in un eventuale salvataggio a file otterrei dei risultati differenti?</p>

<ul>
  <li><strong>spine</strong> e’ il termine tecnico associato agli assi. Se per esempio non voglio che uno degli assi appaia nel grafico posso usare la funzione <strong>despine</strong>. Attenzione che va messo sotto il comando del disegno <strong>joinplot</strong> altrimenti non ha effetto!</li>
  <li>
    <p><strong>set_context</strong> modifica i parametri in modo che la dimensione dei font e del grafico siano proporzionati in base al <strong>contesto</strong>. Per esempio se faccio un poster ho bisogno di label grandi…</p>
  </li>
  <li><strong>set_style</strong> sono le combinazioni di colori dello <code class="language-plaintext highlighter-rouge">sfondo</code></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#sns.set_style ('white')      
</span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span> <span class="p">(</span><span class="s">'darkgrid'</span><span class="p">)</span>
<span class="c1">#sns.set_style ('whitegrid')
#sns.set_style ('ticks')
</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>    <span class="c1"># non funge, devo capire perche'!
</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s">'paper'</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="c1">#sns.set_context('talk', font_scale=1.5)    # ingrandisce tutto
#sns.set_context('poster', font_scale=1.5)
</span>
<span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'speeding'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'alcohol'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">crash_df</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">'reg'</span><span class="p">);</span>

<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>    <span class="c1"># Occhio va messo SOTTO joinplot altrimenti non fa nulla  
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 576x360 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_24_1.png" alt="png" /></p>

<h1 id="categorical-plotting">Categorical Plotting</h1>

<h2 id="bar-plots">Bar Plots</h2>
<p><code class="language-plaintext highlighter-rouge">barplot()</code></p>
<ul>
  <li>di default fa vedere la mean</li>
  <li>La barra nera fa vedre la varianza</li>
  <li>devo passare cosa ci sia sulle x e sulle y  (e il dataframe da cui sono prese)</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'sex'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_27_0.png" alt="png" /></p>

<p>Possiamo usare funzioni diverse per stimare i valori categorici, per esempio tutti quelli
in numpy, come la <strong>mediana</strong>, o la <strong>moda</strong> (non mi e’ riuscito)!</p>

<ul>
  <li>Attento se fai 2 barplot, li sovrappone e non si capisce nulla</li>
  <li>Si possono usare delle funzioni custom fatte da noi, suppongo che di base si debba lavorare con un oggetto di tipo Series di Pandas</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#sns.barplot(x='sex', y='total_bill', data=tips_df , estimator=np.median);   # mediana
#sns.barplot(x='sex', y='total_bill', data=tips_df , estimator=np.std);       # deviazione standard
#sns.barplot(x='sex', y='total_bill', data=tips_df , estimator=np.var);      # varianza
</span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'sex'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span> <span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">);</span>      <span class="c1"># covarianza
</span>
<span class="c1">#from scipy.stats import mode  # non sono riuscito a fargli usare la moda
#sns.barplot(x='sex', y='total_bill', data=tips_df , estimator=mode);
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_29_0.png" alt="png" /></p>

<h2 id="count-plot">Count Plot</h2>
<p><code class="language-plaintext highlighter-rouge">countplot</code></p>

<p>e’ come un barplot ma l’estimatore conta solo il numero di occorrenze, per questo non ha bisogno della y (e’ automaticamente il numero di occorrenze)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'sex'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:xlabel='sex', ylabel='count'&gt;
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_31_1.png" alt="png" /></p>

<h2 id="box-plot">Box Plot</h2>

<p><code class="language-plaintext highlighter-rouge">boxplot()</code></p>

<p>fa vedere il grafico a baffi con i quartili dei dati.</p>

<ul>
  <li>la linea nera e’ la mean</li>
  <li>la scatola si estende di una <strong>deviazione standard</strong> (siamo sicuri? calcola la deviazione standard destra e sinistra? Di solito (wikipedia) la scatola indica il <strong>primo</strong> e il <strong>terzo</strong> quartile, devo controllare).</li>
  <li>I whiskers (baffi) si estendono fino ???    .In alcune rappresentazioni si estendono fino al massimo e al minimo</li>
  <li>
    <p>I punti sono outliers (che non stanno nei baffi). Non e’ spiegato bene nella documentazione di Seaborn. Se usano la convenzione per gli outlier che uso io e’ Q3 + 3 IQ  (dove l’interquartile e’ la differenza tra il terzo e il primo quartile IQ= Q3-Q1).</p>
  </li>
  <li>sulle x vengono selezionati vari insiemi di dati</li>
  <li>sulle y viene fatto il grafico a baffi di quei particolari dati (vedi il grafico che e’ chiaro)</li>
</ul>

<p>L’estensione dei whisker non viene spiegata bene nelle note di Seaborn.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'sex'</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> <span class="c1"># la legenda in alto a sx e' loc =0
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_33_0.png" alt="png" /></p>

<h2 id="violin-plot">Violin Plot</h2>
<p>Una combinazione di boxplot e kde plot, dove usa i kernel. Il nome e’ ovvio…</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'sex'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_35_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># E' inutile mettere tutto il violino per una sola categoria, mettiamo mezzo per una e mezzo per l'altra: split
</span><span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'sex'</span><span class="p">,</span><span class="n">split</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_36_0.png" alt="png" /></p>

<h2 id="strip-plot">Strip plot</h2>
<p><code class="language-plaintext highlighter-rouge">stripplot()</code></p>

<p>si usa quando una variabile e’ categorica:</p>

<ul>
  <li><strong>jitter</strong> non mi pare che faccia una grande differenza, dovrebbe sparpagliare meglio i punti</li>
  <li><strong>hue</strong> funziona assegna dei colori diversi in base ad una variabile categorica</li>
  <li><strong>dodge</strong>, separa fisicamente i punti con hue differente</li>
</ul>

<p>Prima non disegnava correttamente, perche’ dove avevo scritto <code class="language-plaintext highlighter-rouge">fig, ax= plt.subplots(1,2, figsize=(15,5))</code>
avrei invece dovuto scrivere ‘fig, axes=…’</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">######  HO fatto qualche modifica rispetto al video, in modo da paragonare con e senza jitter #####
</span>
<span class="c1">#plt.figure(figsize=(8,5))
</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="p">)</span>        <span class="c1"># grafici uno da parte all'altro
</span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">jitter</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span>
<span class="c1">#fig.show()  # non serve in un jupyter notebook
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_38_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span>  <span class="c1"># jitter muove un po' in giro i punti
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_39_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'sex'</span><span class="p">);</span> 
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_40_0.png" alt="png" /></p>

<p>Separo le hue, ma le lascio allo stesso giorno. Questo viene ottenuto tramite il comando <strong>dodge</strong> separa fisicamente i due gruppi di punti.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'sex'</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> 
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_42_0.png" alt="png" /></p>

<h2 id="swarm-plot-lo-sciame">Swarm plot (lo sciame)</h2>
<p><code class="language-plaintext highlighter-rouge">violinplot()</code></p>

<p>combina i plot precedenti.</p>

<ul>
  <li>in pratica definisce la posizione dei punti come se fossero delle foglie, il primo al centro poi un a dx in alto , sx in alto..</li>
</ul>

<p>Prima <strong>riguardiamo</strong> il violino (poi lo confrontiamo con lo swarmplot)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span> <span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_45_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># poi vediamo lo sciame.
</span><span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span> <span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_46_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># metto insieme il violino e lo sciame
</span><span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span> <span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">);</span>
<span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span> <span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'white'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_47_0.png" alt="png" /></p>

<h1 id="palettes">Palettes</h1>

<p><code class="language-plaintext highlighter-rouge">palette</code> e’ un parametro</p>

<ul>
  <li>una palette e’ un insieme di colori predefiniti.</li>
  <li>in cui definiamo anche una topologia tra colori: ovvero quale colore e’ vicino a quale colore.</li>
  <li>punto di partenza una palette standard</li>
  <li>Le palette si trovano qui: https://matplotlib.org/3.3.3/tutorials/colors/colormaps.html )</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># funge! se non lo metto sotto diventa tutto piu' piccolo
</span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">'dark'</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s">'talk'</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'sex'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_49_0.png" alt="png" /></p>

<p>cambio palette</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'sex'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'PuBu'</span><span class="p">);</span> <span class="c1"># PuBu=palette trovata su matplotlib
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_51_0.png" alt="png" /></p>

<h1 id="legend">Legend</h1>
<p>qualche comando per muovere la legenda.
In teoria:</p>

<ul>
  <li>loc = 0 sceglie lui la posizione ottimale</li>
  <li>upper right=1</li>
  <li>upper left =2</li>
  <li>lower left =3</li>
  <li>lower right =4</li>
</ul>

<p>Cerca Matplotib legends e ci sono tutte le opzioni https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.legend.html</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plt.figure(figsize=(8,5)) # funge! se non lo metto sotto diventa tutto piu' piccolo
</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span> <span class="c1"># funge! se non lo metto sotto diventa tutto piu' piccolo
</span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">'dark'</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s">'talk'</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'sex'</span><span class="p">);</span>
<span class="c1">#plt.legend(loc=0) # best = sceglie lui la posizione
#plt.legend(loc=1) # in alto a dx
#plt.legend(loc=2) # in alto a sx         
#plt.legend(loc=3) # in basso a sx
</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># in basso a dx 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.legend.Legend at 0x12265a93550&gt;
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_53_1.png" alt="png" /></p>

<h1 id="matrix-plot">Matrix Plot</h1>

<p>In questo caso vogliamo <strong>visualizzare una matrice</strong>, ovvero un oggetto con righe e colonne.
In ogni ingresso della matrice avro’ dei valori e voglio visualizzarli.</p>

<!---
Supponiamo di volere fare molti grafici contemporaneamente. Li mettiamo magari uno da parte all'altro sulla stessa riga.
Oppure possiamo metterli uno sopra l'altro. In generale si usa uno schema a matrice, dove devono esserci delle righe e delle colonne, e in ogni caselle vi e' un grafo diverso.
--->

<h2 id="heatmaps">Heatmaps</h2>
<p><code class="language-plaintext highlighter-rouge">heatmap()</code></p>

<p>qui sotto prendiamo il crash_df e cerchiamo di costruire delle heatmaps</p>

<p>argomenti utili:</p>

<ul>
  <li>cmap = ‘Blues’  e’ la colormap</li>
  <li>annot =True   scrivi anche il valore della colorazione nella casella (altrimenti fa solo il colore)</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">crash_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>  <span class="c1"># riguardiamo questo df
</span></code></pre></div></div>

<p>Qui sotto uso un metodo (di Pandas?) per cui</p>

<ul>
  <li>dato un dataframe con valori numerici e categorici</li>
  <li>calcola la correlazione tra ogni coppia di colonne numeriche</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">crash_mx</span> <span class="o">=</span> <span class="n">crash_df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span> 
<span class="n">crash_mx</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total</th>
      <th>speeding</th>
      <th>alcohol</th>
      <th>not_distracted</th>
      <th>no_previous</th>
      <th>ins_premium</th>
      <th>ins_losses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>total</th>
      <td>1.000000</td>
      <td>0.611548</td>
      <td>0.852613</td>
      <td>0.827560</td>
      <td>0.956179</td>
      <td>-0.199702</td>
      <td>-0.036011</td>
    </tr>
    <tr>
      <th>speeding</th>
      <td>0.611548</td>
      <td>1.000000</td>
      <td>0.669719</td>
      <td>0.588010</td>
      <td>0.571976</td>
      <td>-0.077675</td>
      <td>-0.065928</td>
    </tr>
    <tr>
      <th>alcohol</th>
      <td>0.852613</td>
      <td>0.669719</td>
      <td>1.000000</td>
      <td>0.732816</td>
      <td>0.783520</td>
      <td>-0.170612</td>
      <td>-0.112547</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s">'paper'</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
<span class="c1">#sns.heatmap(crash_mx, annot=True, cmap='Blues')   # fa vedere anche i numeri nelle caselle colorate
</span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">crash_mx</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'magma'</span><span class="p">)</span>   <span class="c1"># fa vedere SOLO i colori
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:&gt;
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_59_1.png" alt="png" /></p>

<h2 id="pivot-table">Pivot Table</h2>
<p>questo e’ un altro modo per costruire una matrice.</p>

<p>NEll’esempio sotto quello che fa e’:</p>
<ul>
  <li>indico l’<strong>index</strong> ovvero l’attributo che viene usato per l’indice di riga</li>
  <li>indico le <strong>columns</strong>, ovvero l’attributo che viene usato per l’indice di colonna</li>
  <li>A questo punto lui va. Controlla tutti gli i <strong>valori</strong>  dell’attributo per l’<strong>index</strong>. Li usa per costruire una tabelle di cui sono tutte le <strong>righe</strong>.</li>
  <li>Poi va e controlla i <strong>valori</strong> dell’attributo per le columns e costruisce le <strong>colonne</strong>.</li>
  <li>Poi va e <strong>pesca</strong> per ognuno degli attributi dell’index e delle columns i valori dati come <strong>values</strong> e li mette nelle caselle.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">flights</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s">'flights'</span><span class="p">)</span>
<span class="n">flights</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>passengers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1949</td>
      <td>Jan</td>
      <td>112</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1949</td>
      <td>Feb</td>
      <td>118</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1949</td>
      <td>Mar</td>
      <td>132</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">flights</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'month'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'year'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'passengers'</span><span class="p">)</span>  <span class="c1"># NON lavora INPLACE (invece nel video si')
</span><span class="n">flights_pt</span> <span class="o">=</span> <span class="n">flights</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'month'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'year'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'passengers'</span><span class="p">)</span> 
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#sns.heatmap(flights.pivot_table(index='month', columns='year', values='passengers'), annot=False, cmap='Blues') # IDENTICO
</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span> <span class="p">(</span><span class="n">flights_pt</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">annot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'Blues'</span><span class="p">)</span> 
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span> <span class="p">(</span><span class="n">flights_pt</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">annot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'Blues'</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s">'white'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="c1">#larghezza linea default 0?
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_63_0.png" alt="png" /></p>

<h2 id="cluster-map">Cluster Map</h2>
<p><code class="language-plaintext highlighter-rouge">clustermap()</code></p>

<p>hierarchically clusterd heatmap  = heatmap ottenuta cone una clusterizzazione gerarchica</p>

<ul>
  <li>la distanza tra tutti i punti e’ calcolata</li>
  <li>i piu’ vicini sono uniti</li>
  <li>il lavoro continua con il prossimo vicino</li>
  <li>quindi paragona le colonne e le righe</li>
</ul>

<p>A differenza della heatmap, dove l’ordine degli attributi e’ mantenuto costante, in questo caso
viene riordinato seguendo il clustering.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s">'iris'</span><span class="p">)</span> <span class="c1"># e' un pandas dataframe di default
</span><span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c1">#sns.clustermap(iris)
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">species</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">'species'</span><span class="p">)</span>  <span class="c1"># pop spara fuori una colonna e la trasforma in una Series
</span></code></pre></div></div>

<h2 id="heatmap-ottenuta-con-una-clusterizzazione-gerarchica">Heatmap ottenuta con una clusterizzazione gerarchica</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">clustermap</span><span class="p">(</span><span class="n">iris</span><span class="p">);</span>  <span class="c1"># heatmap ottenuta con una clusterizzazione gerarchica
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_68_0.png" alt="png" /></p>

<p>Ricorda che la pivot table ho dovuto rinominarla, per lui fights e’ la pivot table, per me e’ flights_pt</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#sns.clustermap(flights , cmap ='Blues', standard_scale =1)  # NON FUNGE normalizza i dati per focalizzarci sul clustering 
</span><span class="n">sns</span><span class="o">.</span><span class="n">clustermap</span><span class="p">(</span><span class="n">flights_pt</span> <span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span><span class="s">'Blues'</span><span class="p">,</span> <span class="n">standard_scale</span> <span class="o">=</span><span class="mi">1</span><span class="p">);</span>  <span class="c1"># normalizza i dati per focalizzarci sul clustering 
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_70_0.png" alt="png" /></p>

<p>un commento a quanto qui sopra. Pensale in termine di sequenze numeriche, in cui il colore e’ un numero.
Puoi avere sequenze <strong>verticali</strong> e <strong>orizzontali</strong>.
Prendiamo ora le sequenze orizzontali.
Le due piu’ in alto sono molto chiare, ma non sono le piu’ vicine, infatti Nov e Jan sono connesse. Poi si connette Feb.
Non mi e’ chiaro il dendrogramma come venga poi costruito. Mi pare di capire che alla fine ci possano essere solo delle coppie. Se il primo vicino di una sequenza e’ gia’ in una coppia, questa rimane isolata e va attaccata alla coppia oppure… devo pensare all’algoritmo.</p>

<p>Nota che a causa del clustering mi aspetto di vedere striscie. Questo perche’ sequenze simili vanno messe vicine tra loro.</p>

<p>Potrebbero mettere un puntino al centro di ogni cella. Questo punto si puo’ muovere sull’asse delle z o delle y .Il modvimento e’ lo stesso sui due assi e in questo modo si vedono le sequenze sia guardando le righe che le colonne!</p>

<h2 id="pair-grids">Pair Grids</h2>
<p><code class="language-plaintext highlighter-rouge">PairGrid()</code></p>

<p>Prima abbiamo visto i pairplots, dove si facevano degli scatter plot tra tutte le coppie di colonne del DataFrame.</p>

<p>Per prima cosa creiamo una grid vuota.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s">'iris'</span><span class="p">)</span>
<span class="n">iris_g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'species'</span><span class="p">)</span>  <span class="c1"># assegna un colore diverso alle varie specie
</span><span class="n">iris_g</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">);</span>                     <span class="c1"># questo mi pare un comando di matplotlib o PANDAS
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_74_0.png" alt="png" /></p>

<p>Ora vogliamo mettere un istogramma lungo la diagonale (della griglia di grafici).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris_g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'species'</span><span class="p">)</span>  <span class="c1"># assegna un colore diverso alle varie specie
#iris_g.map(plt.scatter);                    # questo mi pare un comando di matplotlib o PANDAS
</span><span class="n">iris_g</span><span class="o">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">);</span>                  <span class="c1"># nei grafi diagonali inserisce un istogramma
</span><span class="n">iris_g</span><span class="o">.</span><span class="n">map_offdiag</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">);</span>            <span class="c1"># non mette gli scatterplot diagonali! (occhio che devi commentare l'altro!) 
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_76_0.png" alt="png" /></p>

<p>Ora vogliamo mettere delle altre cose nella:</p>
<ul>
  <li>parte <strong>superiore</strong> (della matrice di grafici)</li>
  <li>parte <strong>inferiore</strong> (della matrice di grafici)</li>
</ul>

<p>quindi diamo un comando chen indica cosa mettere sulla diagonale e poi uno per la triangolare superiore e uno per la triangoplar e superiore. Occhio che si deve passare come argomento di</p>

<p><strong>map_diag</strong>  (oppure map_lower o map_upper) il nome della funzione che si userebbe per diegnare un singolo plot di questo tipo.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris_g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'species'</span><span class="p">)</span>  <span class="c1"># assegna un colore diverso alle varie specie
</span><span class="n">iris_g</span><span class="o">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">);</span>                  <span class="c1"># nei grafi diagonali inserisce un istogramma
</span><span class="n">iris_g</span><span class="o">.</span><span class="n">map_upper</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">);</span>              <span class="c1"># sopre metti gli scatter plot 
</span><span class="n">iris_g</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">);</span>              <span class="c1"># sotto metti KDE quindi devi usare la funzione di SEABORN
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_78_0.png" alt="png" /></p>

<h3 id="variabili-per-la-nostra-custom-grid">Variabili per la nostra custom grid</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#iris_g = sns.PairGrid(iris, hue='species')  # assegna un colore diverso alle varie specie
</span><span class="n">iris_g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'species'</span><span class="p">,</span> 
                       <span class="n">x_vars</span><span class="o">=</span><span class="p">[</span><span class="s">"sepal_length"</span><span class="p">,</span> <span class="s">"sepal_width"</span><span class="p">],</span>
                      <span class="n">y_vars</span><span class="o">=</span> <span class="p">[</span><span class="s">"petal_length"</span><span class="p">,</span> <span class="s">"petal_width"</span><span class="p">]</span> <span class="p">)</span>
<span class="n">iris_g</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">);</span>                                         <span class="c1"># map e' usata in modo molto potente
</span><span class="n">iris_g</span><span class="o">.</span><span class="n">add_legend</span><span class="p">();</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_80_0.png" alt="png" /></p>

<h2 id="facet-grid">Facet Grid</h2>
<p><code class="language-plaintext highlighter-rouge">FacetGrid()</code></p>

<p>E’ una specie di subplots di matplotlib ma con delle cose predefinite.</p>

<ul>
  <li>posso disegnare plot multipli in una griglia (grid)</li>
  <li>posso definire le colonne e righe</li>
</ul>

<p>Si crea un sistema a forma di <strong>griglia</strong> (in cui pero’ non abbiamo ancora messo nulla).
Al primo passo indico le colonne e le righe, per esempio:</p>

<ul>
  <li>nelle colonne metto il tempo (time). Che puo’ assumere 2 valori: Dinner e Lunch</li>
  <li>nelle righe metto ‘smoker’. Che puo’ assumere 2 valori: yes e no</li>
</ul>

<p>Quindi la griglia che ho creato e’ 2x2.</p>

<p>In ogni ingresso della griglia  devo mettere un grafico.
Cosa metto?</p>

<h2 id="map">Map</h2>
<p>Il metodo <code class="language-plaintext highlighter-rouge">map()</code> di python e’ utilissimo perche’ posso passare anche delle funzioni!</p>

<p>Mappo ogni grafo con il metodo map() e faccio un istogramma 
della quantita’ ‘total_bill’.</p>

<p>Queste quantita’ saranno <strong>limitata</strong> al valore di ‘time’ e ‘smoker’
corrispondente alla griglia!</p>

<p>Quindi per esempio in alto a sx:</p>
<ul>
  <li>smoker = yes</li>
  <li>time = lunch</li>
</ul>

<p>Faccio l’istogramma di tutti i ‘total_bill’ che si riferiscono a smoker e lunch.</p>

<p>Ricapitolando con FacetGrid definisco una griglia associata a due colonne,
che formeranno le righe e le colonne della griglia. Per ogni valore di ciascuna
delle due colonne faccio un grafico riferito, ad una <strong>terza colonna</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tips_fg</span><span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">'time'</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s">'smoker'</span><span class="p">)</span>  <span class="c1"># qui resta vuota.
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_82_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s">'paper'</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">tips_fg</span><span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">'time'</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s">'smoker'</span><span class="p">)</span>
<span class="n">tips_fg</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">,</span> <span class="s">'total_bill'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">8</span> <span class="p">);</span>                 <span class="c1"># mappa la funzione plt.hist, sulla quantita 'total_bill' 
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_83_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tips_fg</span><span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">'time'</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s">'smoker'</span><span class="p">)</span>
<span class="n">tips_fg</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">,</span> <span class="s">'day'</span> <span class="p">)</span>   
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;seaborn.axisgrid.FacetGrid at 0x122685a3ac0&gt;
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_84_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tips_fg</span><span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">'time'</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s">'smoker'</span><span class="p">)</span>
<span class="n">tips_fg</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">,</span> <span class="s">'total_bill'</span><span class="p">,</span> <span class="s">'tip'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_85_0.png" alt="png" /></p>

<p>Nel caso sotto invece, facciamo una griglia che contiene solo colonne.
Non ci sono righe, pero’ adesso usiamo il comando hue che ci permette di usare un colore diverso
in base all’argomento usato. In questo caso uso come hue=’smoker’</p>

<p>Aggiungo un prametro, col_order che mi consente di ordinare le colonne. Basta mettere una lista contenente 
il nome delle colonne volute e l’ordine di quella lista sara’ seguito dal plot.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tips_fg</span><span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">'time'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'smoker'</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">col_order</span><span class="o">=</span><span class="p">[</span><span class="s">'Dinner'</span><span class="p">,</span><span class="s">'Lunch'</span><span class="p">]</span>
                      <span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'Set1'</span><span class="p">)</span>
<span class="n">tips_fg</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">,</span> <span class="s">'total_bill'</span><span class="p">,</span> <span class="s">'tip'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span><span class="s">'w'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_87_0.png" alt="png" /></p>

<h2 id="gli-stili-le-linee-etc">Gli stili, le linee etc</h2>

<ul>
  <li>creo quindi un dizionario, in cui ci sono i parametri, lo chiamo <strong>kws</strong>
 costruisco una Griglia faccettata (FacedGrid), in cui:</li>
  <li>le colonne sono i valori di ‘sex’</li>
  <li>punti che corrispondono a fumatori e non fumatori sono in colori diversi hue=’smoker’</li>
  <li>altezza = 4  height=4</li>
  <li>aspect = 1.3  (non ricordo cosa faccia)</li>
</ul>

<p>a questo punto mappo la funzione plt.scatter sulla griglia faccettata, tramite <strong>map</strong>.
Alla funzione map passo 3 parametri:</p>
<ul>
  <li>le x che sono ‘total_bill’</li>
  <li>le y che e’ ‘tip’</li>
  <li>kws    <strong>sintassi strana</strong> devo mettere due asterischi *, davanti al dizionario quando lo passo!</li>
</ul>

<p>Ho trovato che non gli piace il fatto che definisca le colonne della FacetGrid tramite 
la variabile ‘sex’, forse perche’ e’ categorica? se metto time funge.
Ho trovato l’errore.</p>

<p>Io non penso in modo “case sensitive”, nell’esempio si mette <code class="language-plaintext highlighter-rouge">hue_order=['yes', 'No']</code>, io
invece avevo preso tutto in minuscolo. Per questo non scriveva nulla: non c’era 
corrispondenza tra:</p>
<ul>
  <li>i valori dello hue: Yes,No</li>
  <li>i valori dello hue_order: yes, no</li>
</ul>

<p><strong>Attento</strong> devi controllare che negli argomenti ci sia perfetta corrispondenza tra i nomi!</p>

<p><strong>Domanda</strong> cosa fanno i doppi asterischi davanti al dizinoario? 
<strong>Risposta</strong> fa un-packing dell’oggetto.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span><span class="s">'w'</span><span class="p">)</span>  <span class="c1"># ho creato un dizionario con 3 ingressi
</span>
<span class="n">tips_fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span><span class="s">'sex'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'smoker'</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> 
                        <span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="s">'Yes'</span><span class="p">,</span> <span class="s">'No'</span><span class="p">],</span> 
                        <span class="n">hue_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="p">[</span><span class="s">'^'</span><span class="p">,</span><span class="s">'v'</span><span class="p">]))</span>   <span class="c1"># triangolini in su e triangolini in giu'
</span>
<span class="n">tips_fg</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">,</span> <span class="s">'total_bill'</span><span class="p">,</span> <span class="s">'tip'</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">);</span>     <span class="c1"># nota sintattica, qui gli passo **
</span></code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_89_0.png" alt="png" /></p>

<h2 id="altro-dataset-attention">Altro dataset: attention</h2>

<p>Ho degli studenti, ne voglio mettere 5 per linea.
Per fare questo indico solo quale sia la variabile che uso per le colonne
Poi tramite col_warps=5 indico che devono esserci solo 5 colonne al max, poi
 va a capo lui automaticamente</p>

<ul>
  <li>numero di colonne per linea <code class="language-plaintext highlighter-rouge">col_wrap=5</code></li>
  <li>se non uso <code class="language-plaintext highlighter-rouge">col_wrap=5</code> lui mette ogni valore di subject in una colonna diversa, ce ne sono 20…</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">att_df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s">'attention'</span><span class="p">)</span>
<span class="n">att_fg</span>  <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">att_df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">'subject'</span><span class="p">)</span>
<span class="n">att_fg</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span> <span class="s">'solutions'</span><span class="p">,</span> <span class="s">'score'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">'.'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;seaborn.axisgrid.FacetGrid at 0x122692041f0&gt;
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_91_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">att_fg</span>  <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">att_df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">'subject'</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">att_fg</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span> <span class="s">'solutions'</span><span class="p">,</span> <span class="s">'score'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">'.'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;seaborn.axisgrid.FacetGrid at 0x1226863a4f0&gt;
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_92_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">att_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>subject</th>
      <th>attention</th>
      <th>solutions</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>divided</td>
      <td>1</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>divided</td>
      <td>1</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>divided</td>
      <td>1</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>

<h1 id="regression-plots">Regression Plots</h1>
<p>Uso tip data, faccio uno scatter plot con interpolazione.</p>

<p><code class="language-plaintext highlighter-rouge">lmplot()</code>  (linear regression?)</p>

<p>Faccio due interpolazioni diverse per ognuno delle differenti <strong>hue</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s">'paper'</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'tip'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'sex'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">tips_df</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s">'o'</span><span class="p">,</span> <span class="s">'^'</span><span class="p">],</span> 
          <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'s'</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="s">'linewidth'</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s">'edgecolor'</span><span class="p">:</span><span class="s">'w'</span><span class="p">});</span>
<span class="c1"># regression plot
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 576x432 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_95_1.png" alt="png" /></p>

<p>Qui sotto usa i comandi <strong>col</strong> e <strong>row</strong> per costruire una sorta di FacetGrid automatica, 
tramite la funzione lmlpot (che fa la regressione).</p>

<p>Anche in questo caso  viene costruita una griglia.</p>

<p>Questa griglia seleziona i punti e poi per i punti che hanno le caratteristiche 
che combaciano con quelle della griglia si fa il regression plot</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'tip'</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">'sex'</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s">'time'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_97_0.png" alt="png" /></p>

<h1 id="salvare-le-figure">Salvare le figure</h1>
<p>Per salvare i file si usano semplicemente le funzioni di Matplotlib.
In praticolare si deve:</p>
<ul>
  <li>chiamare una funzione che faccia un’immagine</li>
  <li>subito dopo chiamare <code class="language-plaintext highlighter-rouge">plt.savefig('nomeImmagine.eps')</code></li>
  <li>cambiando l’estensione si ottengono file diversi, per esempio <code class="language-plaintext highlighter-rouge">png, pdf,...</code></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'tip'</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">'sex'</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s">'time'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'prova.pdf'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_99_0.png" alt="png" /></p>

<h1 id="subplots-matplotlib">Subplots (Matplotlib)</h1>
<p>questo e’ piu’ correlato con matplotlib, comunque e’ utile anche in questo notebook.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#import pandas as pd
#import seaborn as sns
#from matplotlib import pyplot as plt
</span><span class="n">pokemon</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'pokemon.csv'</span><span class="p">)</span>
<span class="c1">#p_df.head()
</span>
<span class="c1"># bulbasaur = pokemon[['Name', 'HP', 'Attack', 'Defense', 'Sp. Atk', 'Sp. Def', 'Speed']][pokemon.loc[:, 'Name'] == 'Bulbasaur']
</span><span class="n">poke_num</span> <span class="o">=</span> <span class="n">pokemon</span><span class="p">[[</span><span class="s">'Name'</span><span class="p">,</span> <span class="s">'HP'</span><span class="p">,</span> <span class="s">'Attack'</span><span class="p">,</span> <span class="s">'Defense'</span><span class="p">,</span> <span class="s">'Sp. Atk'</span><span class="p">,</span> <span class="s">'Sp. Def'</span><span class="p">,</span> <span class="s">'Speed'</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'Name'</span><span class="p">)</span>

<span class="n">bulbasaur</span> <span class="o">=</span> <span class="n">poke_num</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Bulbasaur'</span><span class="p">]</span>
<span class="n">charmander</span> <span class="o">=</span> <span class="n">poke_num</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Charmander'</span><span class="p">]</span>
<span class="n">squirtle</span> <span class="o">=</span> <span class="n">poke_num</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Squirtle'</span><span class="p">]</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'Initial Pokemon - 1st Generation'</span><span class="p">)</span>

<span class="c1"># Bulbasaur
</span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">bulbasaur</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">bulbasaur</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">bulbasaur</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># Charmander
</span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">charmander</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">charmander</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">charmander</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># Squirtle
</span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">squirtle</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">squirtle</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">squirtle</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5, 1.0, 'Squirtle')
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_101_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tips_df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s">'tips'</span><span class="p">)</span>

<span class="c1">#fig, axes =plt.subplots(1,3, figsize=(15,5), sharey=True)
</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'magma'</span><span class="p">)</span>                <span class="c1"># FUNGE 
</span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'PuOr'</span><span class="p">)</span>    <span class="c1"># FUNGE 
</span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s">'day'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'total_bill'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips_df</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'winter'</span><span class="p">)</span>  <span class="c1"># FUNGE
</span>
<span class="c1">#sns.stripplot( x='day', y='total_bill', data=tips_df)                # NON FUNGE 
#sns.stripplot( x='day', y='total_bill', data=tips_df, jitter=True)   # NON FUNGE 
#sns.stripplot( x='day', y='total_bill', data=tips_df, jitter=True)   # NON FUNGE
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:xlabel='day', ylabel='total_bill'&gt;
</code></pre></div></div>

<p><img src="/images/posts/Seaborn_files/Seaborn_102_1.png" alt="png" /></p>


      </div>
    </div>

    <div class="tag-list">
      
      
      
      <a class="tag-chip" href="/tags#paolo_cap"><div class="chip z-depth-1">Paolo</div></a>
      
      
      
      <a class="tag-chip" href="/tags#python_cap"><div class="chip z-depth-1">Python</div></a>
      
    </div>
    
    		
			<script src="  https://unpkg.com/showdown/dist/showdown.min.js"></script>
<script>
const GH_API_URL = 'https://api.github.com/repos/4phycs/4phycs.github.io/issues/26/comments';

let request = new XMLHttpRequest();
request.open( 'GET', GH_API_URL, true );
request.onload = function() {
	if ( this.status >= 200 && this.status < 400 ) {
		let response = JSON.parse( this.response );

		for ( var i = 0; i < response.length; i++ ) {
			document.getElementById( 'gh-comments-list' ).appendChild( createCommentEl( response[ i ] ) );
		}

		if ( 0 === response.length ) {
			document.getElementById( 'no-comments-found' ).style.display = 'block';
		}
	} else {
		console.error( this );
	}
};

function createCommentEl( response ) {
	let user = document.createElement( 'a' );
	user.setAttribute( 'href', response.user.url.replace( 'api.github.com/users', 'github.com' ) );
	user.classList.add( 'user' );

	let userAvatar = document.createElement( 'img' );
	userAvatar.classList.add( 'avatar' );
	userAvatar.setAttribute( 'src', response.user.avatar_url );

	user.appendChild( userAvatar );

	let commentLink = document.createElement( 'a' );
	commentLink.setAttribute( 'href', response.html_url );
	commentLink.classList.add( 'comment-url' );
	commentLink.innerHTML = '#' + response.id + ' - ' + response.created_at;

	let commentContents = document.createElement( 'div' );
	commentContents.classList.add( 'comment-content' );
	commentContents.innerHTML = response.body;
	// Progressive enhancement.
	if ( window.showdown ) {
		let converter = new showdown.Converter();
		commentContents.innerHTML = converter.makeHtml( response.body );
	}

	let comment = document.createElement( 'li' );
	comment.setAttribute( 'data-created', response.created_at );
	comment.setAttribute( 'data-author-avatar', response.user.avatar_url );
	comment.setAttribute( 'data-user-url', response.user.url );

	comment.appendChild( user );
	comment.appendChild( commentContents );
	comment.appendChild( commentLink );

	return comment;
}
request.send();
</script>

<hr>

<div class="github-comments">
	<h2>Comments</h2>
	<ul id="gh-comments-list"></ul>
	<div class="buttonArea">
	  <a target="_blank" href="https://github.com/4phycs/4phycs.github.io/issues/26"class="button">Add comment (via Github)</a>
	</div>
</div>


		
 
  </div>
</main>

	<script src="/assets/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript">
  jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
      //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
      offset_opacity = 1200,
      //duration of the top scrolling animation (in ms)
      scroll_top_duration = 700,
      //grab the "back to top" link
      $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
      ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
      // if( $(this).scrollTop() > offset_opacity ) { 
      //  $back_to_top.addClass('cd-fade-out');
      // }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
      event.preventDefault();
      $('body,html').animate({
        scrollTop: 0 ,
        }, scroll_top_duration
      );
    });

  });
</script>
<style type="text/css">
.cd-top {
  display: inline-block;
  height: 50px;
  width: 50px;
  position: fixed;
  bottom: 2%;
  right: 2%;
  border-radius: 40px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
  /* image replacement properties */
  overflow: hidden;
  text-indent: 100%;
  white-space: nowrap;
  background: #bbb url(/images/cd-top-arrow.svg) no-repeat center 50%;
  visibility: hidden;
  opacity: 0;
  -webkit-transition: opacity .3s 0s, visibility 0s .3s;
  -moz-transition: opacity .3s 0s, visibility 0s .3s;
  transition: opacity .3s 0s, visibility 0s .3s;
}
.cd-top.cd-is-visible, .cd-top.cd-fade-out, .no-touch .cd-top:hover {
  -webkit-transition: opacity .3s 0s, visibility 0s 0s;
  -moz-transition: opacity .3s 0s, visibility 0s 0s;
  transition: opacity .3s 0s, visibility 0s 0s;
}
.cd-top.cd-is-visible {
  /* the button becomes visible */
  visibility: visible;
  opacity: 1;
}
.cd-top.cd-fade-out {
  /* if the user keeps scrolling down, the button is out of focus and becomes less visible */
  opacity: .5;
}
.no-touch .cd-top:hover {
  background-color: #e86256;
  opacity: 1;
}
</style>

<a href="#0" class="cd-top">Top</a>
	<footer class="page-footer light-blue accent-4">  
  <div class="footer-copyright">
    <div class="container text-white">
     <a href="">4Phycs</a> &#xA9; 2021 Inherited from <a href="https://shawnteoh.github.io/matjek/">MatJeck</a>.
    </div>
  </div>
</footer>

<script src="//code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/materialize/0.99.0/js/materialize.min.js"></script>


  
    <script src="/assets/js/post.js"></script>
  





<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})
  (window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>

<script src="/assets/js/main.js"></script>

        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-158698892-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158698892-1');
</script>

</body>
</html>
